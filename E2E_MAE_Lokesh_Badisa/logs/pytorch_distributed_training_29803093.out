/bin/bash: module: line 1: syntax error: unexpected end of file
/bin/bash: error importing function definition for `module'
/bin/bash: ml: line 1: syntax error: unexpected end of file
/bin/bash: error importing function definition for `ml'
/bin/bash: module: line 1: syntax error: unexpected end of file
/bin/bash: error importing function definition for `module'
/bin/bash: ml: line 1: syntax error: unexpected end of file
/bin/bash: error importing function definition for `ml'
/bin/bash: module: line 1: syntax error: unexpected end of file
/bin/bash: error importing function definition for `module'
/bin/bash: ml: line 1: syntax error: unexpected end of file
/bin/bash: error importing function definition for `ml'
/bin/bash: ml: line 1: syntax error: unexpected end of file
/bin/bash: error importing function definition for `ml'
/bin/bash: module: line 1: syntax error: unexpected end of file
/bin/bash: error importing function definition for `module'



=============
== PyTorch ==
=============

== PyTorch ==
=============
== PyTorch ==
=============
=============
=============
== PyTorch ==
=============
=============

NVIDIA Release 24.05 (build 91431255)
PyTorch Version 2.4.0a0+07cecf4

NVIDIA Release 24.05 (build 91431255)
PyTorch Version 2.4.0a0+07cecf4

NVIDIA Release 24.05 (build 91431255)
PyTorch Version 2.4.0a0+07cecf4

NVIDIA Release 24.05 (build 91431255)
PyTorch Version 2.4.0a0+07cecf4
Container image Copyright (c) 2024, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
Container image Copyright (c) 2024, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
Container image Copyright (c) 2024, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
Container image Copyright (c) 2024, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
Copyright (c) 2014-2024 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.
Copyright (c) 2014-2024 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.
Copyright (c) 2014-2024 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.
Copyright (c) 2014-2024 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license
/opt/nvidia/entrypoint.d/50-gpu-driver-check.sh: line 5: ldconfig: command not found
/opt/nvidia/entrypoint.d/50-gpu-driver-check.sh: line 5: ldconfig: command not found
/opt/nvidia/entrypoint.d/50-gpu-driver-check.sh: line 5: ldconfig: command not found
/opt/nvidia/entrypoint.d/50-gpu-driver-check.sh: line 5: ldconfig: command not found

WARNING: The NVIDIA Driver was not detected.  GPU functionality will not be available.
   Use the NVIDIA Container Toolkit to start this container with GPU support; see
   https://docs.nvidia.com/datacenter/cloud-native/ .

WARNING: The NVIDIA Driver was not detected.  GPU functionality will not be available.
   Use the NVIDIA Container Toolkit to start this container with GPU support; see
   https://docs.nvidia.com/datacenter/cloud-native/ .

WARNING: The NVIDIA Driver was not detected.  GPU functionality will not be available.
   Use the NVIDIA Container Toolkit to start this container with GPU support; see
   https://docs.nvidia.com/datacenter/cloud-native/ .

WARNING: The NVIDIA Driver was not detected.  GPU functionality will not be available.
   Use the NVIDIA Container Toolkit to start this container with GPU support; see
   https://docs.nvidia.com/datacenter/cloud-native/ .




environ({'echo "Shell debugging temporarily silenced: export LMOD_SH_DBG_ON': '1 for Lmod\'s output" 1>&2;', 'BASH_FUNC_module%%': '() {  if [ -z "${LMOD_SH_DBG_ON+x}" ]; then', 'BASH_FUNC_ml%%': '() {  eval "$($LMOD_DIR/ml_cmd "$@")"', 'NPP_VERSION': '12.2.5.30', 'SHELL': '/bin/bash', 'PE_MPICH_GTL_LIBS_amd_gfx90a': '-lmpi_gtl_hsa', 'CRAY_LMOD_CPU': 'x86-milan/1.0', 'LMOD_SITE_NAME': 'NERSC', 'NVIDIA_VISIBLE_DEVICES': 'all', 'GCC_PATH': '/usr/bin', 'COLORTERM': 'truecolor', 'SDK_HOME': '/usr/lib64/jvm/java', 'DALI_BUILD': '14636516', 'SLURM_JOB_USER': 'lokeshb', 'CRAY_DSMML_PREFIX': '/opt/cray/pe/dsmml/0.2.2/dsmml', 'LIBGL_ALWAYS_INDIRECT': '1', 'XDG_CONFIG_DIRS': '/etc/xdg', 'SLURM_TASKS_PER_NODE': '4', 'LESS': '-M -I -R', 'CUSOLVER_VERSION': '11.6.1.9', 'SLURM_JOB_UID': '105785', 'PELOCAL_PRGENV': 'true', 'TERM_PROGRAM_VERSION': '1.92.2', 'JDK_HOME': '/usr/lib64/jvm/java', 'SLURM_TASK_PID': '1609451', 'PE_LIBSCI_GENCOMPS_GNU_x86_64': '123', '__LMOD_REF_COUNT_LMOD_MODULERCFILE': '/opt/cray/pe/cpe/23.12/modulerc.lua:1', 'CRAY_PE_LIBSCI_BASE_DIR': '/opt/cray/pe/libsci/23.12.5', 'CRAYPE_VERSION': '2.7.30', 'CUBLAS_VERSION': '12.4.5.8', 'PE_PRODUCT_LIST': 'CRAYPE:CRAYPE_X86_MILAN:PERFTOOLS:CRAYPAT:CRAY_HPC_SDK:CRAY_ACCEL', 'MACHTYPE': 'x86_64-suse-linux', 'SLURM_JOB_GPUS': '0,1,2,3', 'PKG_CONFIG_PATH': '/opt/cray/pe/modulefiles/cudatoolkit:/opt/cray/pe/craype/2.7.30/pkg-config:/opt/cray/pe/dsmml/0.2.2/dsmml/lib/pkgconfig:/opt/cray/libfabric/1.15.2.0/lib64/pkgconfig', 'SLURM_LOCALID': '0', 'PKGCONFIG_ENABLED': '1', 'SLURM_SUBMIT_DIR': '/global/u1/l/lokeshb/E2E/E2E_MAE_Lokesh_Badisa', 'G_BROKEN_FILENAMES': '1', 'LMOD_FAMILY_PRGENV_VERSION': '8.5.0', 'PE_MPICH_GTL_LIBS_amd_gfx906': '-lmpi_gtl_hsa', 'HOSTNAME': 'nid001036', 'HISTSIZE': '1000', 'PE_MPICH_GTL_LIBS_amd_gfx908': '-lmpi_gtl_hsa', 'FROM_HEADER': '', 'LMOD_CACHED_LOADS': 'no', 'MINICOM': '-c on', '__LMOD_REF_COUNT_PE_MPICH_PKGCONFIG_LIBS': 'mpich:1', 'PSCRATCH': '/pscratch/sd/l/lokeshb', 'SLURMD_NODENAME': 'nid001036', 'CRAY_XPMEM_POST_LINK_OPTS': '-L/opt/cray/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta/lib64', '_ModuleTable011_': 'MDAwMDAyMy4wMDAwMDAwMTIuKnpmaW5hbCIsCn0sCnhwbWVtID0gewpmbiA9ICIvb3B0L2NyYXkvbW9kdWxlZmlsZXMveHBtZW0vMi42LjItMi41XzIuMzhfX2dkMDY3YzNmLnNoYXN0YSIsCmZ1bGxOYW1lID0gInhwbWVtLzIuNi4yLTIuNV8yLjM4X19nZDA2N2MzZi5zaGFzdGEiLApsb2FkT3JkZXIgPSA0LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gInhwbWVtIiwKd1YgPSAiXjAwMDAwMDAyLjAwMDAwMDAwNi4wMDAwMDAwMDIuKnpmaW5hbC0uMDAwMDAwMDAyLjAwMDAwMDAwNS4qXy4wMDAwMDAwMDIuMDAwMDAwMDM4LipfLipfLipnZC4wMDAwMDAwNjcuKmMuMDAwMDAwMDAzLipmLipzaGFzdGEuKnpmaW5hbCIs', 'LMOD_FAMILY_PRGENV': 'PrgEnv-gnu', 'SLURM_JOB_START_TIME': '1724686112', 'PE_GNU_FIXED_PKGCONFIG_PATH': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib/pkgconfig', 'JAVA_ROOT': '/usr/lib64/jvm/java', 'HYDRA_LAUNCHER_EXTRA_ARGS': '--external-launcher', 'JAVA_HOME': '/usr/lib64/jvm/java', '_ModuleTable007_': 'bE5hbWUgPSAiY3JheXBlLW5ldHdvcmstb2ZpIiwKbG9hZE9yZGVyID0gMywKcHJvcFQgPSB7fSwKc3RhY2tEZXB0aCA9IDAsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJjcmF5cGUtbmV0d29yay1vZmkiLAp3ViA9ICJNLip6ZmluYWwiLAp9LApbImNyYXlwZS14ODYtbWlsYW4iXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUteDg2LW1pbGFuLmx1YSIsCmZ1bGxOYW1lID0gImNyYXlwZS14ODYtbWlsYW4iLApsb2FkT3JkZXIgPSAxLApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXlwZS14ODYtbWlsYW4iLAp3ViA9ICJN', 'NVIDIA_REQUIRE_CUDA': 'cuda>=9.0', 'CUFFT_VERSION': '11.2.1.3', 'FI_CXI_RX_MATCH_MODE': 'hybrid', '_ModuleTable002_': 'PSAiY3JheS1tcGljaCIsCn0sCm1UID0gewpbIlByZ0Vudi1nbnUiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9QcmdFbnYtZ251LzguNS4wLmx1YSIsCmZ1bGxOYW1lID0gIlByZ0Vudi1nbnUvOC41LjAiLApsb2FkT3JkZXIgPSA1LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gIlByZ0Vudi1nbnUvOC41LjAiLAp3ViA9ICJeMDAwMDAwMDguMDAwMDAwMDA1Lip6ZmluYWwiLAp9LApjcGUgPSB7CmZuID0gIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmUvY3BlLzIzLjEyLmx1YSIsCmZ1bGxOYW1lID0gImNwZS8yMy4xMiIsCmxvYWRPcmRlciA9IDEyLApwcm9wVCA9', 'JRE_HOME': '/usr/lib64/jvm/java', 'PE_MPICH_GTL_DIR_nvidia70': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'CRAY_CUDATOOLKIT_PREFIX': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'PE_PERFTOOLS_MPICH_LIBDIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib', '__LMOD_REF_COUNT_MODULEPATH': '/opt/cray/pe/lmod/modulefiles/perftools/23.12.0:1;/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0:1;/opt/cray/pe/lmod/modulefiles/mix_compilers:1;/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0:1;/opt/cray/pe/lmod/modulefiles/mpi/gnu/12.0/ofi/1.0/cray-mpich/8.0:1;/opt/cray/pe/lmod/modulefiles/net/ofi/1.0:1;/opt/cray/pe/lmod/modulefiles/cpu/x86-milan/1.0:1;/opt/cray/pe/modulefiles/Linux:1;/opt/cray/pe/modulefiles/Core:1;/opt/cray/pe/lmod/lmod/modulefiles/Core:1;/opt/cray/pe/lmod/modulefiles/core:1;/opt/cray/pe/lmod/modulefiles/craype-targets/default:1;/global/common/software/nersc/pe/modulefiles_hotfixes:1;/opt/nersc/pe/modulefiles:1;/usr/share/lmod/lmod/modulefiles/Core:1;/opt/cray/modulefiles:1', 'SLURM_TRES_BIND': 'gres/gpu:per_task:1', 'PE_PKGCONFIG_PRODUCTS': 'PE_MPICH:PE_LIBSCI:PE_DSMML:PE_XPMEM', 'CPU': 'x86_64', 'MPICH_DIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'CUDA_CACHE_DISABLE': '1', 'TENSORBOARD_PORT': '6006', '_ModuleTable005_': 'b2FkT3JkZXIgPSA4LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXktbXBpY2gvOC4xLjI4IiwKd1YgPSAiXjAwMDAwMDA4LjAwMDAwMDAwMS4wMDAwMDAwMjguKnpmaW5hbCIsCn0sCmNyYXlwZSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9jcmF5cGUvMi43LjMwLmx1YSIsCmZ1bGxOYW1lID0gImNyYXlwZS8yLjcuMzAiLApsb2FkT3JkZXIgPSA5LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXlwZS8yLjcuMzAiLAp3ViA9ICJeMDAwMDAwMDIuMDAwMDAwMDA3LjAwMDAwMDAzMC4qemZpbmFsIiwKfSwKWyJj', 'CRAY_LD_LIBRARY_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:/opt/cray/pe/perftools/23.12.0/lib64:/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib:/opt/cray/pe/mpich/8.1.28/gtl/lib:/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64/lib:/opt/cray/pe/dsmml/0.2.2/dsmml/lib', 'SLURM_CLUSTER_NAME': 'perlmutter', 'CRAY_LMOD_MPI': 'cray-mpich/8.0', 'JAVA_BINDIR': '/usr/lib64/jvm/java/bin', 'SLURM_JOB_END_TIME': '1724687912', 'MPICH_GPU_SUPPORT_ENABLED': '1', 'CRAY_CUDATOOLKIT_VERSION': '23.9_12.2', 'MAN_POSIXLY_CORRECT': '1', 'LMOD_ADMIN_FILE': '/opt/nersc/pe/etc/lmod/admin.list', 'LMOD_FAMILY_HARDWARE': 'gpu', 'SLURM_CPUS_ON_NODE': '128', 'GCC_VERSION': '12.3', 'LMOD_FAMILY_HARDWARE_VERSION': '1.0', 'TORCH_CUDA_ARCH_LIST': '5.2 6.0 6.1 7.0 7.2 7.5 8.0 8.6 8.7 9.0+PTX', 'LMOD_RC': '/opt/nersc/pe/etc/lmod/lmodrc.lua', 'PE_MPICH_PKGCONFIG_LIBS': 'mpich', 'PE_LIBSCI_REQUIRED_PRODUCTS': 'PE_MPICH', 'NCCL_VERSION': '2.21.5', 'OFFLOAD_INIT': 'on_start', 'PE_XPMEM_PKGCONFIG_LIBS': 'cray-xpmem', 'PE_MPICH_GTL_LIBS_nvidia90': '-lmpi_gtl_cuda', 'SLURM_JOB_CPUS_PER_NODE': '128', 'CRAY_DSMML_VER': '0.2.2', 'GPG_TTY': '/dev/pts/198', 'NCCL_SOCKET_IFNAME': 'hsn', 'LMOD_DIR': '/opt/cray/pe/lmod/lmod/libexec', 'PE_LIBSCI_PKGCONFIG_LIBS': 'libsci_mpi:libsci', 'NCCL_NET_GDR_LEVEL': 'PHB', 'CRAY_LMOD_NET': 'ofi/1.0', 'CUSPARSE_VERSION': '12.3.1.170', 'ENV': '/etc/shinit_v2', 'SLURM_GPUS_ON_NODE': '4', 'PRTE_MCA_plm_slurm_args': '--external-launcher', 'PWD': '/workspace', 'SLURM_GTIDS': '0', 'CRAY_MPICH_ROOTDIR': '/opt/cray/pe/mpich/8.1.28', 'LOGNAME': 'lokeshb', 'CRAY_CUDATOOLKIT_POST_LINK_OPTS': '-L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64 -Wl,--as-needed,-lcupti,-lcudart,--no-as-needed -lcuda', '__LMOD_REF_COUNT_CRAY_LD_LIBRARY_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:1;/opt/cray/pe/perftools/23.12.0/lib64:1;/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib:1;/opt/cray/pe/mpich/8.1.28/gtl/lib:1;/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64/lib:1;/opt/cray/pe/dsmml/0.2.2/dsmml/lib:1', 'XDG_SESSION_TYPE': 'tty', '__LMOD_REF_COUNT_PE_LIBSCI_REQUIRED_PRODUCTS': 'PE_MPICH:1', 'PE_MPICH_GTL_DIR_nvidia80': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SLURM_JOB_PARTITION': 'gpu_ss11', 'OPENUCX_VERSION': '1.17.0', 'MODULESHOME': '/opt/cray/pe/lmod/lmod', 'NSIGHT_SYSTEMS_VERSION': '2024.2.1.106', 'NVIDIA_DRIVER_CAPABILITIES': 'compute,utility,video', 'CRAY_MPICH_PREFIX': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'MANPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/doc/man:/opt/cray/pe/perftools/23.12.0/man:/opt/cray/pe/papi/7.0.1.2/share/pdoc/man:/opt/cray/pe/craype/2.7.30/man:/opt/cray/pe/mpich/8.1.28/ofi/man:/opt/cray/pe/mpich/8.1.28/man/mpich:/opt/cray/pe/libsci/23.12.5/share/man:/opt/cray/pe/dsmml/0.2.2/dsmml/man:/opt/cray/libfabric/1.15.2.0/share/man:/opt/cray/pe/lmod/lmod/share/man:/usr/local/man:/usr/share/man:/usr/man', 'SLURM_TRES_PER_TASK': 'cpu:32,gres/gpu:1', 'POLYGRAPHY_VERSION': '0.49.10', 'LMOD_CASE_INDEPENDENT_SORTING': 'yes', 'SLURM_JOB_NUM_NODES': '1', 'UCC_CL_BASIC_TLS': '^sharp', '_ModuleTable008_': 'Lip6ZmluYWwiLAp9LApjdWRhdG9vbGtpdCA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9jdWRhdG9vbGtpdC8xMi4yLmx1YSIsCmZ1bGxOYW1lID0gImN1ZGF0b29sa2l0LzEyLjIiLApsb2FkT3JkZXIgPSAxMywKcHJvcFQgPSB7fSwKc3RhY2tEZXB0aCA9IDEsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJjdWRhdG9vbGtpdCIsCndWID0gIl4wMDAwMDAxMi4wMDAwMDAwMDIuKnpmaW5hbCIsCn0sClsiZ2NjLW5hdGl2ZSJdID0gewpmbiA9ICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlL2djYy1uYXRpdmUvMTIuMy5sdWEiLApmdWxsTmFtZSA9ICJnY2MtbmF0aXZlLzEyLjMiLApsb2FkT3JkZXIgPSAxMCwKcHJv', 'PE_DSMML_MODULE_NAME': 'cray-dsmml', 'TZ': 'America/Los_Angeles', 'TRT_VERSION': '10.0.1.6', 'VSCODE_GIT_ASKPASS_NODE': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/node', 'SLURM_JOBID': '29803093', '_ModuleTable013_': 'aWxhbi8xLjAiCiwgIi9vcHQvY3JheS9wZS9tb2R1bGVmaWxlcy9MaW51eCIsICIvb3B0L2NyYXkvcGUvbW9kdWxlZmlsZXMvQ29yZSIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jcmF5cGUtdGFyZ2V0cy9kZWZhdWx0IgosICIvZ2xvYmFsL2NvbW1vbi9zb2Z0d2FyZS9uZXJzYy9wZS9tb2R1bGVmaWxlc19ob3RmaXhlcyIKLCAiL29wdC9uZXJzYy9wZS9tb2R1bGVmaWxlcyIsICIvdXNyL3NoYXJlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlIiwgIi9vcHQvY3JheS9tb2R1bGVmaWxlcyIsCn0sCnN5c3RlbUJh', 'container': 'podman', 'NVIDIA_PRODUCT_NAME': 'PyTorch', 'RDMACORE_VERSION': '39.0', 'NVIDIA_CPU_ONLY': '1', 'SLURM_JOB_QOS': 'gpu_debug', 'I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS': '--external-launcher', 'XKEYSYMDB': '/usr/X11R6/lib/X11/XKeysymDB', 'CRAY_ACCEL_VENDOR': 'nvidia', '__LMOD_REF_COUNT_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/compute-sanitizer:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/bin:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/libnvvp:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Compute:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Systems/bin:1;/opt/cray/pe/perftools/23.12.0/bin:1;/opt/cray/pe/papi/7.0.1.2/bin:1;/opt/cray/pe/craype/2.7.30/bin:1;/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/bin:1;/opt/cray/pe/mpich/8.1.28/bin:1;/opt/cray/libfabric/1.15.2.0/bin:1;/usr/local/bin:1;/usr/bin:1;/bin:1;/usr/lib/mit/bin:1;/opt/cray/pe/bin:1', 'XNLSPATH': '/usr/X11R6/lib/X11/nls', 'HOME': '/global/homes/l/lokeshb', 'PE_MPICH_FIXED_PRGENV': 'GNU', '__LMOD_REF_COUNT_PE_MPICH_GENCOMPILERS_GNU': '12.3:1', 'APP2_STATE': '23.12.0', '_ModuleTable_Sz_': '14', 'CRAY_MPICH_DIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'LANG': 'en_US.UTF-8', 'HUGETLB_VERBOSE': '0', '__LMOD_REF_COUNT_PKG_CONFIG_PATH': '/opt/cray/pe/modulefiles/cudatoolkit:1;/opt/cray/pe/craype/2.7.30/pkg-config:1;/opt/cray/pe/dsmml/0.2.2/dsmml/lib/pkgconfig:1;/opt/cray/libfabric/1.15.2.0/lib64/pkgconfig:1', 'SLURM_PROCID': '0', 'CRAY_LMOD_COMPILER': 'gnu/12.0', '__LMOD_REF_COUNT_PE_GNU_FIXED_PKGCONFIG_PATH': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib/pkgconfig:1', 'CRAY_ACCEL_TARGET': 'nvidia80', 'PE_MPICH_GTL_DIR_amd_gfx942': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SCRATCH': '/pscratch/sd/l/lokeshb', 'PE_MPICH_GTL_DIR_amd_gfx940': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'COCOAPI_VERSION': '2.0+nv0.8.0', 'MPICH_MPIIO_DVS_MAXNODES': '24', 'CUDA_VERSION': '12.4.1.003', 'LMOD_FAMILY_GCC_COMPILER_VERSION': '12.3', '__LMOD_REF_COUNT_CPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include:1', 'LMOD_SETTARG_FULL_SUPPORT': 'no', 'PYTORCH_VERSION': '2.4.0a0+07cecf4', 'CURAND_VERSION': '10.3.5.147', 'OSTYPE': 'linux', 'TMPDIR': '/tmp', 'GIT_ASKPASS': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/extensions/git/dist/askpass.sh', '__lmod_sh_dbg': "'x'", 'PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION': 'python', '_ModuleTable010_': 'MS4xNS4yLjAiLApsb2FkT3JkZXIgPSAyLApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImxpYmZhYnJpYyIsCndWID0gIl4wMDAwMDAwMS4wMDAwMDAwMTUuMDAwMDAwMDAyLip6ZmluYWwiLAp9LApbInBlcmZ0b29scy1iYXNlIl0gPSB7CmZuID0gIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmUvcGVyZnRvb2xzLWJhc2UvMjMuMTIuMC5sdWEiLApmdWxsTmFtZSA9ICJwZXJmdG9vbHMtYmFzZS8yMy4xMi4wIiwKbG9hZE9yZGVyID0gMTEsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAicGVyZnRvb2xzLWJhc2UvMjMuMTIuMCIsCndWID0gIl4w', 'SLURM_CPUS_PER_TASK': '32', 'SLURM_NTASKS': '4', 'PYTORCH_BUILD_NUMBER': '0', 'GNU_VERSION': '12.3', 'LMOD_FAMILY_CRAYPE_NETWORK': 'craype-network-ofi', 'LESS_ADVANCED_PREPROCESSOR': 'no', 'LMOD_FAMILY_GCC_COMPILER': 'gcc-native', 'SLURM_TOPOLOGY_ADDR': 'nid001036', 'LMOD_VERSION': '8.7.31', 'PE_LIBSCI_PKGCONFIG_VARIABLES': 'PE_LIBSCI_OMP_REQUIRES_@openmp@:PE_SCI_EXT_LIBPATH:PE_SCI_EXT_LIBNAME', 'LMOD_FAMILY_CRAYPE_ACCEL': 'craype-accel-nvidia80', 'PODMANHPC_MODULES_DIR': '/etc/podman_hpc/modules.d', 'SSH_CONNECTION': '103.232.241.199 35000 128.55.126.1 22', 'USE_EXPERIMENTAL_CUDNN_V8_API': '1', 'CUTENSOR_VERSION': '2.0.1.2', 'CRAYPAT_LD_LIBRARY_PATH': '/opt/cray/pe/perftools/23.12.0/lib64', 'PIP_DEFAULT_TIMEOUT': '100', 'LMOD_IGNORE_CACHE': '1', 'LMOD_PACKAGE_PATH': '/opt/nersc/pe/etc/lmod/sitepackages', 'PE_GCC_EXTERNAL': 'native', '__LMOD_REF_COUNT_PE_DSMML_PKGCONFIG_LIBS': 'dsmml:1', 'NVFUSER_BUILD_VERSION': '0ff5802', 'CRAY_CPU_TARGET': 'x86-milan', 'HPCX_VERSION': '2.19', 'CRAY_PE_LIBSCI_PREFIX_DIR': '/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64', 'CRAYPE_DIR': '/opt/cray/pe/craype/2.7.30', 'CRAY_XPMEM_INCLUDE_OPTS': '-I/opt/cray/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta/include', '_ModuleTable003_': 'IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNwZSIsCndWID0gIl4wMDAwMDAyMy4wMDAwMDAwMTIuKnpmaW5hbCIsCn0sClsiY3JheS1kc21tbCJdID0gewpmbiA9ICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlL2NyYXktZHNtbWwvMC4yLjIubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1kc21tbC8wLjIuMiIsCmxvYWRPcmRlciA9IDYsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheS1kc21tbC8wLjIuMiIsCndWID0gIl4wMDAwMDAwMC4wMDAwMDAwMDIuMDAwMDAwMDAyLip6ZmluYWwiLAp9LApbImNyYXktbGlic2NpIl0gPSB7CmZuID0gIi9vcHQv', 'HYDRA_BOOTSTRAP': 'slurm', 'MODULEPATH_ROOT': '/opt/cray/pe/modulefiles', 'NVM_DIR': '/usr/local/nvm', 'TORCH_CUDNN_V8_API_ENABLED': '1', 'VSCODE_GIT_ASKPASS_EXTRA_ARGS': '', 'CUDA_VISIBLE_DEVICES': '0,1,2,3', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'PE_MPICH_GTL_LIBS_nvidia80': '-lmpi_gtl_cuda', 'PE_PKGCONFIG_LIBS': 'cudatoolkit_12.2:mpich:libsci_mpi:libsci:dsmml', 'LESSCLOSE': 'lessclose.sh %s %s', 'PE_MPICH_GENCOMPILERS_GNU': '12.3', 'LMOD_FAMILY_CRAYPE_ACCEL_VERSION': 'false', 'XDG_SESSION_CLASS': 'user', 'LMOD_PKG': '/opt/cray/pe/lmod/lmod', 'SLURM_SCRIPT_CONTEXT': 'prolog_task', 'PE_LIBSCI_GENCOMPILERS_GNU_x86_64': '12.3', 'PYTHONPATH': '/opt/nersc/pymon', 'TERM': 'xterm-256color', 'PE_MPICH_GTL_DIR_ponteVecchio': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'LMOD_FAMILY_CRAYPE_CPU_VERSION': 'false', 'G_FILENAME_ENCODING': '@locale,UTF-8,ISO-8859-15,CP1252', 'HOST': 'login15', 'GDRCOPY_VERSION': '2.3.1-1', 'PE_MPICH_FORTRAN_PKGCONFIG_LIBS': 'mpichf90', 'NVFUSER_VERSION': '0ff5802', 'LESSOPEN': 'lessopen.sh %s', 'PE_MPICH_GTL_DIR_nvidia90': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'USER': 'lokeshb', 'CFS': '/global/cfs/cdirs', 'CRAY_DSMML_DIR': '/opt/cray/pe/dsmml/0.2.2/dsmml', 'OPENMPI_VERSION': '4.1.7', 'PE_LIBSCI_VOLATILE_PRGENV': 'GNU', 'LMOD_FAMILY_LIBSCI_VERSION': '23.12.5', 'NVJPEG_VERSION': '12.3.1.117', 'LMOD_FAMILY_CRAYPE_VERSION': '2.7.30', 'LIBRARY_PATH': '/usr/local/cuda/lib64/stubs:', 'SLURM_NODELIST': 'nid001036', 'PE_DSMML_PKGCONFIG_LIBS': 'dsmml', '__LMOD_REF_COUNT_PE_MPICH_FORTRAN_PKGCONFIG_LIBS': 'mpichf90:1', 'VSCODE_GIT_IPC_HANDLE': '/run/user/105785/vscode-git-9051b97600.sock', 'PYTHONIOENCODING': 'utf-8', 'ENVIRONMENT': 'BATCH', 'CRAYPAT_OPTS_EXECUTABLE': 'libexec64/opts', 'PE_MPICH_GTL_LIBS_amd_gfx942': '-lmpi_gtl_hsa', 'CRAYPAT_ROOT': '/opt/cray/pe/perftools/23.12.0', 'PE_MPICH_GTL_LIBS_amd_gfx940': '-lmpi_gtl_hsa', 'MORE': '-sl', 'CRAY_MPICH_VER': '8.1.28', 'LOADEDMODULES': 'craype-x86-milan:libfabric/1.15.2.0:craype-network-ofi:xpmem/2.6.2-2.5_2.38__gd067c3f.shasta:PrgEnv-gnu/8.5.0:cray-dsmml/0.2.2:cray-libsci/23.12.5:cray-mpich/8.1.28:craype/2.7.30:gcc-native/12.3:perftools-base/23.12.0:cpe/23.12:cudatoolkit/12.2:craype-accel-nvidia80:gpu/1.0', 'SLURM_JOB_ACCOUNT': 'm4392_g', 'CSHEDIT': 'emacs', 'SLURM_PRIO_PROCESS': '0', 'PE_LIBSCI_OMP_REQUIRES': ' ', 'CRAY_DSMML_ROOTDIR': '/opt/cray/pe/dsmml/0.2.2', 'NERSC_LMOD_CONFIGDIR': '/opt/nersc/pe/etc/lmod', 'SLURM_NPROCS': '4', 'LMOD_ROOT': '/opt/cray/pe/lmod', 'NVHPC_CUDA_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'SHLVL': '5', '_ModuleTable012_': 'Cn0sCn0sCm1wYXRoQSA9IHsKIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL3BlcmZ0b29scy8yMy4xMi4wIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb21uZXQvZ251LzEyLjAvb2ZpLzEuMCIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvbWl4X2NvbXBpbGVycyIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29tcGlsZXIvZ251LzEyLjAiCiwgIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL21waS9nbnUvMTIuMC9vZmkvMS4wL2NyYXktbXBpY2gvOC4wIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9uZXQvb2ZpLzEuMCIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3B1L3g4Ni1t', 'CRAYPE_NETWORK_TARGET': 'ofi', 'SLURM_NNODES': '1', 'BASH_ENV': '/opt/cray/pe/lmod/lmod/init/bash', '__LMOD_REF_COUNT_PE_MPICH_FIXED_PRGENV': 'GNU:1', 'PE_MPICH_GTL_LIBS_nvidia70': '-lmpi_gtl_cuda', '_ModuleTable006_': 'cmF5cGUtYWNjZWwtbnZpZGlhODAiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUtYWNjZWwtbnZpZGlhODAubHVhIiwKZnVsbE5hbWUgPSAiY3JheXBlLWFjY2VsLW52aWRpYTgwIiwKbG9hZE9yZGVyID0gMTQsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheXBlLWFjY2VsLW52aWRpYTgwIiwKd1YgPSAiTS4qemZpbmFsIiwKfSwKWyJjcmF5cGUtbmV0d29yay1vZmkiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUtbmV0d29yay1vZmkubHVhIiwKZnVs', 'WINDOWMANAGER': 'xterm', 'PAGER': 'less', 'CRAY_DSMML_BASEDIR': '/opt/cray/pe/dsmml/0.2.2', 'CRAYPE_LINK_TYPE': 'dynamic', 'CRAY_TCMALLOC_MEMFS_FORCE': '1', 'LMOD_sys': 'Linux', 'PE_LIBSCI_OMP_REQUIRES_openmp': '_mp', 'PAT_RT_PERFCTR_DISABLE_COMPONENTS': 'nvml,rocm_smi', 'PE_LIBSCI_MODULE_NAME': 'cray-libsci/23.12.5', '__LMOD_REF_COUNT_PE_FORTRAN_PKGCONFIG_LIBS': 'mpichf90:1', 'LIBGL_DEBUG': 'quiet', 'PE_ENV': 'GNU', 'CUDNN_VERSION': '9.1.0.70', '_ModuleTable009_': 'cFQgPSB7fSwKc3RhY2tEZXB0aCA9IDEsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJnY2MtbmF0aXZlLzEyLjMiLAp3ViA9ICJeMDAwMDAwMTIuMDAwMDAwMDAzLip6ZmluYWwiLAp9LApncHUgPSB7CmZuID0gIi9vcHQvbmVyc2MvcGUvbW9kdWxlZmlsZXMvZ3B1LzEuMC5sdWEiLApmdWxsTmFtZSA9ICJncHUvMS4wIiwKbG9hZE9yZGVyID0gMTUsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAwLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiZ3B1IiwKd1YgPSAiMDAwMDAwMDAxLip6ZmluYWwiLAp9LApsaWJmYWJyaWMgPSB7CmZuID0gIi9vcHQvY3JheS9tb2R1bGVmaWxlcy9saWJmYWJyaWMvMS4xNS4yLjAiLApmdWxsTmFtZSA9ICJsaWJmYWJyaWMv', 'HDF5_USE_FILE_LOCKING': 'FALSE', 'PE_MPICH_GTL_LIBS_ponteVecchio': '-lmpi_gtl_ze', '__LMOD_REF_COUNT_MANPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/doc/man:1;/opt/cray/pe/perftools/23.12.0/man:1;/opt/cray/pe/papi/7.0.1.2/share/pdoc/man:1;/opt/cray/pe/craype/2.7.30/man:1;/opt/cray/pe/mpich/8.1.28/ofi/man:1;/opt/cray/pe/mpich/8.1.28/man/mpich:1;/opt/cray/pe/libsci/23.12.5/share/man:1;/opt/cray/pe/dsmml/0.2.2/dsmml/man:1;/opt/cray/libfabric/1.15.2.0/share/man:1;/opt/cray/pe/lmod/lmod/share/man:1;/usr/local/man:1;/usr/share/man:1;/usr/man:1', 'CRAY_MPICH_VERSION': '8.1.28', 'PERFTOOLS_VERSION': '23.12.0', 'XDG_SESSION_ID': '148161', 'NSIGHT_COMPUTE_VERSION': '2024.1.1.4', 'SLURM_SUBMIT_HOST': 'login15', 'DALI_VERSION': '1.37.1', '_ModuleTable001_': 'X01vZHVsZVRhYmxlXyA9IHsKTVR2ZXJzaW9uID0gMywKY19yZWJ1aWxkVGltZSA9IGZhbHNlLApjX3Nob3J0VGltZSA9IGZhbHNlLApkZXB0aFQgPSB7fSwKZmFtaWx5ID0gewpQcmdFbnYgPSAiUHJnRW52LWdudSIsCmNvbXBpbGVyID0gImdjYy1uYXRpdmUiLApjcmF5cGUgPSAiY3JheXBlIiwKY3JheXBlX2FjY2VsID0gImNyYXlwZS1hY2NlbC1udmlkaWE4MCIsCmNyYXlwZV9jcHUgPSAiY3JheXBlLXg4Ni1taWxhbiIsCmNyYXlwZV9uZXR3b3JrID0gImNyYXlwZS1uZXR3b3JrLW9maSIsCmN1ZGF0b29sa2l0ID0gImN1ZGF0b29sa2l0IiwKZ2NjX2NvbXBpbGVyID0gImdjYy1uYXRpdmUiLApoYXJkd2FyZSA9ICJncHUiLApsaWJzY2kgPSAiY3JheS1saWJzY2kiLAptcGkg', 'JUPYTER_PORT': '8888', 'PYTORCH_HOME': '/opt/pytorch/pytorch', 'LD_LIBRARY_PATH': '/usr/local/cuda-12.2/compat:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:/opt/cray/pe/papi/7.0.1.2/lib64:/opt/cray/libfabric/1.15.2.0/lib64:/opt/cray/libfabric/1.15.2.0/lib64', 'LMOD_FAMILY_CRAYPE_NETWORK_VERSION': 'false', 'NVIDIA_BUILD_ID': '91431255', 'LMOD_FAMILY_COMPILER': 'gcc-native', 'XDG_RUNTIME_DIR': '/run/user/105785', 'SLURM_JOB_ID': '29803093', '_ModuleTable014_': 'c2VNUEFUSCA9ICIvb3B0L2NyYXkvcGUvbW9kdWxlZmlsZXMvTGludXg6L29wdC9jcmF5L3BlL21vZHVsZWZpbGVzL0NvcmU6L29wdC9jcmF5L3BlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlOi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmU6L29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdDovZ2xvYmFsL2NvbW1vbi9zb2Z0d2FyZS9uZXJzYy9wZS9tb2R1bGVmaWxlc19ob3RmaXhlczovb3B0L25lcnNjL3BlL21vZHVsZWZpbGVzOi91c3Ivc2hhcmUvbG1vZC9sbW9kL21vZHVsZWZpbGVzL0NvcmU6L29wdC9jcmF5L21vZHVsZWZpbGVzIiwKfQo=', 'PE_MPICH_GTL_DIR_amd_gfx90a': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SLURM_NODEID': '0', '_ModuleTable004_': 'Y3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvbXBpbGVyL2dudS8xMi4wL2NyYXktbGlic2NpLzIzLjEyLjUubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1saWJzY2kvMjMuMTIuNSIsCmxvYWRPcmRlciA9IDcsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheS1saWJzY2kvMjMuMTIuNSIsCndWID0gIl4wMDAwMDAyMy4wMDAwMDAwMTIuMDAwMDAwMDA1Lip6ZmluYWwiLAp9LApbImNyYXktbXBpY2giXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29tbmV0L2dudS8xMi4wL29maS8xLjAvY3JheS1tcGljaC84LjEuMjgubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1tcGljaC84LjEuMjgiLAps', 'LMOD_FAMILY_MPI_VERSION': '8.1.28', 'CRAY_PERFTOOLS_PREFIX': '/opt/cray/pe/perftools/23.12.0', 'LMOD_MODULERCFILE': '/opt/nersc/pe/etc/lmod/modulerc.lua', 'SSH_CLIENT': '103.232.241.199 35000 22', '__lmod_my_status': '$?;', 'OMPI_MCA_coll_hcoll_enable': '0', 'FI_MR_CACHE_MONITOR': 'userfaultfd', 'XTPE_LINK_TYPE': 'dynamic', 'OPAL_PREFIX': '/opt/hpcx/ompi', 'LMOD_FAMILY_MPI': 'cray-mpich', 'CSHRCREAD': 'true', 'LMOD_SYSHOST': 'perlmutter', 'CRAY_MPICH_BASEDIR': '/opt/cray/pe/mpich/8.1.28/ofi', 'CUDA_DRIVER_VERSION': '550.54.15', 'LC_ALL': 'C.UTF-8', 'TRANSFORMER_ENGINE_VERSION': '1.6', 'LMOD_FAMILY_COMPILER_VERSION': '12.3', 'PYTORCH_BUILD_VERSION': '2.4.0a0+07cecf4', '_CUDA_COMPAT_PATH': '/usr/local/cuda/compat', 'VSCODE_GIT_ASKPASS_MAIN': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/extensions/git/dist/askpass-main.js', 'CUDA_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'NERSC_HOST': 'perlmutter', 'CRAY_PERFTOOLS_VERSION': '23.12.0', 'PE_GCC_LEVEL': '12', 'PE_MPICH_GTL_DIR_amd_gfx908': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'PE_MPICH_GTL_DIR_amd_gfx906': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'CUDA_MODULE_LOADING': 'LAZY', 'XDG_DATA_DIRS': '/usr/share', '__LMOD_REF_COUNT_PE_PRODUCT_LIST': 'CRAYPE:1;CRAYPE_X86_MILAN:1;PERFTOOLS:1;CRAYPAT:1;CRAY_HPC_SDK:1;CRAY_ACCEL:1', 'SLURM_JOB_LICENSES': 'u1:1', 'SRUN_CPUS_PER_TASK': '32', 'LMOD_FAMILY_LIBSCI': 'cray-libsci', 'GCC_PREFIX': '/usr/lib64/gcc/x86_64-suse-linux/12', 'NVIDIA_REQUIRE_JETPACK_HOST_MOUNTS': '', 'BROWSER': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/bin/helpers/browser.sh', 'PATH': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/bin/remote-cli:/opt/nersc/pe/bin:/global/common/software/nersc/bin:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/compute-sanitizer:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/bin:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/libnvvp:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Compute:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Systems/bin:/opt/cray/pe/perftools/23.12.0/bin:/opt/cray/pe/papi/7.0.1.2/bin:/opt/cray/pe/craype/2.7.30/bin:/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/bin:/opt/cray/pe/mpich/8.1.28/bin:/opt/cray/libfabric/1.15.2.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/lib/mit/bin:/opt/cray/pe/bin', 'SLURM_JOB_NAME': 'pytorch_distributed_training', 'MODULEPATH': '/opt/cray/pe/lmod/modulefiles/perftools/23.12.0:/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0:/opt/cray/pe/lmod/modulefiles/mix_compilers:/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0:/opt/cray/pe/lmod/modulefiles/mpi/gnu/12.0/ofi/1.0/cray-mpich/8.0:/opt/cray/pe/lmod/modulefiles/net/ofi/1.0:/opt/cray/pe/lmod/modulefiles/cpu/x86-milan/1.0:/opt/cray/pe/modulefiles/Linux:/opt/cray/pe/modulefiles/Core:/opt/cray/pe/lmod/lmod/modulefiles/Core:/opt/cray/pe/lmod/modulefiles/core:/opt/cray/pe/lmod/modulefiles/craype-targets/default:/global/common/software/nersc/pe/modulefiles_hotfixes:/opt/nersc/pe/modulefiles:/usr/share/lmod/lmod/modulefiles/Core:/opt/cray/modulefiles', '__LMOD_REF_COUNT_PE_PKGCONFIG_PRODUCTS': 'PE_MPICH:1;PE_LIBSCI:1;PE_DSMML:1;PE_XPMEM:1', 'SLURM_NTASKS_PER_NODE': '4', '_LMFILES_': '/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-x86-milan.lua:/opt/cray/modulefiles/libfabric/1.15.2.0:/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-network-ofi.lua:/opt/cray/modulefiles/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta:/opt/cray/pe/lmod/modulefiles/core/PrgEnv-gnu/8.5.0.lua:/opt/cray/pe/lmod/modulefiles/core/cray-dsmml/0.2.2.lua:/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0/cray-libsci/23.12.5.lua:/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0/cray-mpich/8.1.28.lua:/opt/cray/pe/lmod/modulefiles/core/craype/2.7.30.lua:/opt/cray/pe/lmod/modulefiles/core/gcc-native/12.3.lua:/opt/cray/pe/lmod/modulefiles/core/perftools-base/23.12.0.lua:/opt/cray/pe/lmod/modulefiles/core/cpe/23.12.lua:/opt/cray/pe/lmod/modulefiles/core/cudatoolkit/12.2.lua:/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-accel-nvidia80.lua:/opt/nersc/pe/modulefiles/gpu/1.0.lua', 'CRAY_CUDATOOLKIT_INCLUDE_OPTS': '-I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include', 'CRAY_CUDATOOLKIT_DIR': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/105785/bus', 'LMOD_FAMILY_CRAYPE_CPU': 'craype-x86-milan', 'PROFILEREAD': 'true', 'LMOD_CMD': '/opt/cray/pe/lmod/lmod/libexec/lmod', 'LMOD_SYSTEM_NAME': 'perlmutter', 'PE_LIBSCI_VOLATILE_PKGCONFIG_PATH': '/opt/cray/pe/libsci/23.12.5/@PRGENV@/@PE_LIBSCI_GENCOMPS@/@PE_LIBSCI_TARGET@/lib/pkgconfig', 'MOFED_VERSION': '5.4-rdmacore39.0', 'MAIL': '/var/spool/mail/lokeshb', 'HOSTTYPE': 'x86_64', '__LMOD_REF_COUNT_LD_LIBRARY_PATH': '/usr/local/cuda-12.2/compat:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:1;/opt/cray/pe/papi/7.0.1.2/lib64:1;/opt/cray/libfabric/1.15.2.0/lib64:1', 'CRAY_DSMML_VERSION': '0.2.2', 'NVIDIA_PYTORCH_VERSION': '24.05', '__LMOD_REF_COUNT_PE_PKGCONFIG_LIBS': 'cudatoolkit_12.2:1;mpich:1;libsci_mpi:1;libsci:1;dsmml:1', 'TRTOSS_VERSION': '24.05', 'LMOD_SYSTEM_DEFAULT_MODULES': 'craype-x86-milan:craype-network-ofi:perftools-base:xpmem:PrgEnv-gnu:cpe:gpu', 'OMPI_MCA_plm_slurm_args': '--external-launcher', 'SLURM_JOB_GID': '105785', 'LMOD_FAMILY_CRAYPE': 'craype', 'CPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include', 'CRAY_PE_LIBSCI_VERSION': '23.12.5', 'LESSKEY': '/etc/lesskey.bin', 'TORCH_ALLOW_TF32_CUBLAS_OVERRIDE': '1', 'CUDATOOLKIT_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'SLURM_JOB_NODELIST': 'nid001036', 'PE_MPICH_MODULE_NAME': 'cray-mpich', 'CRAY_PE_LIBSCI_PREFIX': '/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64', 'LMOD_FAMILY_CUDATOOLKIT_VERSION': '12.2', 'TERM_PROGRAM': 'vscode', 'MPICH_OFI_CXI_environ({'echo "Shell debugging temporarily silenced: export LMOD_SH_DBG_ON': '1 for Lmod\'s output" 1>&2;', 'BASH_FUNC_module%%': '() {  if [ -z "${LMOD_SH_DBG_ON+x}" ]; then', 'BASH_FUNC_ml%%': '() {  eval "$($LMOD_DIR/ml_cmd "$@")"', 'NPP_VERSION': '12.2.5.30', 'SHELL': '/bin/bash', 'PE_MPICH_GTL_LIBS_amd_gfx90a': '-lmpi_gtl_hsa', 'CRAY_LMOD_CPU': 'x86-milan/1.0', 'LMOD_SITE_NAME': 'NERSC', 'NVIDIA_VISIBLE_DEVICES': 'all', 'COLORTERM': 'truecolor', 'GCC_PATH': '/usr/bin', 'SDK_HOME': '/usr/lib64/jvm/java', 'DALI_BUILD': '14636516', 'SLURM_JOB_USER': 'lokeshb', 'CRAY_DSMML_PREFIX': '/opt/cray/pe/dsmml/0.2.2/dsmml', 'LIBGL_ALWAYS_INDIRECT': '1', 'XDG_CONFIG_DIRS': '/etc/xdg', 'SLURM_TASKS_PER_NODE': '4', 'LESS': '-M -I -R', 'SLURM_JOB_UID': '105785', 'CUSOLVER_VERSION': '11.6.1.9', 'PELOCAL_PRGENV': 'true', 'TERM_PROGRAM_VERSION': '1.92.2', 'JDK_HOME': '/usr/lib64/jvm/java', 'SLURM_TASK_PID': '1609451', 'PE_LIBSCI_GENCOMPS_GNU_x86_64': '123', '__LMOD_REF_COUNT_LMOD_MODULERCFILE': '/opt/cray/pe/cpe/23.12/modulerc.lua:1', 'CRAY_PE_LIBSCI_BASE_DIR': '/opt/cray/pe/libsci/23.12.5', 'CRAYPE_VERSION': '2.7.30', 'CUBLAS_VERSION': '12.4.5.8', 'PE_PRODUCT_LIST': 'CRAYPE:CRAYPE_X86_MILAN:PERFTOOLS:CRAYPAT:CRAY_HPC_SDK:CRAY_ACCEL', 'MACHTYPE': 'x86_64-suse-linux', 'PKG_CONFIG_PATH': '/opt/cray/pe/modulefiles/cudatoolkit:/opt/cray/pe/craype/2.7.30/pkg-config:/opt/cray/pe/dsmml/0.2.2/dsmml/lib/pkgconfig:/opt/cray/libfabric/1.15.2.0/lib64/pkgconfig', 'SLURM_JOB_GPUS': '0,1,2,3', 'SLURM_LOCALID': '0', 'PKGCONFIG_ENABLED': '1', 'SLURM_SUBMIT_DIR': '/global/u1/l/lokeshb/E2E/E2E_MAE_Lokesh_Badisa', 'G_BROKEN_FILENAMES': '1', 'LMOD_FAMILY_PRGENV_VERSION': '8.5.0', 'PE_MPICH_GTL_LIBS_amd_gfx906': '-lmpi_gtl_hsa', 'HISTSIZE': '1000', 'HOSTNAME': 'nid001036', 'FROM_HEADER': '', 'PE_MPICH_GTL_LIBS_amd_gfx908': '-lmpi_gtl_hsa', 'LMOD_CACHED_LOADS': 'no', 'MINICOM': '-c on', 'PSCRATCH': '/pscratch/sd/l/lokeshb', '__LMOD_REF_COUNT_PE_MPICH_PKGCONFIG_LIBS': 'mpich:1', 'SLURMD_NODENAME': 'nid001036', 'CRAY_XPMEM_POST_LINK_OPTS': '-L/opt/cray/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta/lib64', 'LMOD_FAMILY_PRGENV': 'PrgEnv-gnu', '_ModuleTable011_': 'MDAwMDAyMy4wMDAwMDAwMTIuKnpmaW5hbCIsCn0sCnhwbWVtID0gewpmbiA9ICIvb3B0L2NyYXkvbW9kdWxlZmlsZXMveHBtZW0vMi42LjItMi41XzIuMzhfX2dkMDY3YzNmLnNoYXN0YSIsCmZ1bGxOYW1lID0gInhwbWVtLzIuNi4yLTIuNV8yLjM4X19nZDA2N2MzZi5zaGFzdGEiLApsb2FkT3JkZXIgPSA0LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gInhwbWVtIiwKd1YgPSAiXjAwMDAwMDAyLjAwMDAwMDAwNi4wMDAwMDAwMDIuKnpmaW5hbC0uMDAwMDAwMDAyLjAwMDAwMDAwNS4qXy4wMDAwMDAwMDIuMDAwMDAwMDM4LipfLipfLipnZC4wMDAwMDAwNjcuKmMuMDAwMDAwMDAzLipmLipzaGFzdGEuKnpmaW5hbCIs', 'SLURM_JOB_START_TIME': '1724686112', 'PE_GNU_FIXED_PKGCONFIG_PATH': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib/pkgconfig', 'JAVA_ROOT': '/usr/lib64/jvm/java', 'HYDRA_LAUNCHER_EXTRA_ARGS': '--external-launcher', 'JAVA_HOME': '/usr/lib64/jvm/java', 'NVIDIA_REQUIRE_CUDA': 'cuda>=9.0', '_ModuleTable007_': 'bE5hbWUgPSAiY3JheXBlLW5ldHdvcmstb2ZpIiwKbG9hZE9yZGVyID0gMywKcHJvcFQgPSB7fSwKc3RhY2tEZXB0aCA9IDAsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJjcmF5cGUtbmV0d29yay1vZmkiLAp3ViA9ICJNLip6ZmluYWwiLAp9LApbImNyYXlwZS14ODYtbWlsYW4iXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUteDg2LW1pbGFuLmx1YSIsCmZ1bGxOYW1lID0gImNyYXlwZS14ODYtbWlsYW4iLApsb2FkT3JkZXIgPSAxLApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXlwZS14ODYtbWlsYW4iLAp3ViA9ICJN', 'CUFFT_VERSION': '11.2.1.3', 'FI_CXI_RX_MATCH_MODE': 'hybrid', '_ModuleTable002_': 'PSAiY3JheS1tcGljaCIsCn0sCm1UID0gewpbIlByZ0Vudi1nbnUiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9QcmdFbnYtZ251LzguNS4wLmx1YSIsCmZ1bGxOYW1lID0gIlByZ0Vudi1nbnUvOC41LjAiLApsb2FkT3JkZXIgPSA1LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gIlByZ0Vudi1nbnUvOC41LjAiLAp3ViA9ICJeMDAwMDAwMDguMDAwMDAwMDA1Lip6ZmluYWwiLAp9LApjcGUgPSB7CmZuID0gIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmUvY3BlLzIzLjEyLmx1YSIsCmZ1bGxOYW1lID0gImNwZS8yMy4xMiIsCmxvYWRPcmRlciA9IDEyLApwcm9wVCA9', 'JRE_HOME': '/usr/lib64/jvm/java', 'PE_MPICH_GTL_DIR_nvidia70': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'CRAY_CUDATOOLKIT_PREFIX': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'PE_PERFTOOLS_MPICH_LIBDIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib', '__LMOD_REF_COUNT_MODULEPATH': '/opt/cray/pe/lmod/modulefiles/perftools/23.12.0:1;/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0:1;/opt/cray/pe/lmod/modulefiles/mix_compilers:1;/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0:1;/opt/cray/pe/lmod/modulefiles/mpi/gnu/12.0/ofi/1.0/cray-mpich/8.0:1;/opt/cray/pe/lmod/modulefiles/net/ofi/1.0:1;/opt/cray/pe/lmod/modulefiles/cpu/x86-milan/1.0:1;/opt/cray/pe/modulefiles/Linux:1;/opt/cray/pe/modulefiles/Core:1;/opt/cray/pe/lmod/lmod/modulefiles/Core:1;/opt/cray/pe/lmod/modulefiles/core:1;/opt/cray/pe/lmod/modulefiles/craype-targets/default:1;/global/common/software/nersc/pe/modulefiles_hotfixes:1;/opt/nersc/pe/modulefiles:1;/usr/share/lmod/lmod/modulefiles/Core:1;/opt/cray/modulefiles:1', 'SLURM_TRES_BIND': 'gres/gpu:per_task:1', 'PE_PKGCONFIG_PRODUCTS': 'PE_MPICH:PE_LIBSCI:PE_DSMML:PE_XPMEM', 'CPU': 'x86_64', 'MPICH_DIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'CUDA_CACHE_DISABLE': '1', '_ModuleTable005_': 'b2FkT3JkZXIgPSA4LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXktbXBpY2gvOC4xLjI4IiwKd1YgPSAiXjAwMDAwMDA4LjAwMDAwMDAwMS4wMDAwMDAwMjguKnpmaW5hbCIsCn0sCmNyYXlwZSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9jcmF5cGUvMi43LjMwLmx1YSIsCmZ1bGxOYW1lID0gImNyYXlwZS8yLjcuMzAiLApsb2FkT3JkZXIgPSA5LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXlwZS8yLjcuMzAiLAp3ViA9ICJeMDAwMDAwMDIuMDAwMDAwMDA3LjAwMDAwMDAzMC4qemZpbmFsIiwKfSwKWyJj', 'TENSORBOARD_PORT': '6006', 'CRAY_LD_LIBRARY_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:/opt/cray/pe/perftools/23.12.0/lib64:/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib:/opt/cray/pe/mpich/8.1.28/gtl/lib:/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64/lib:/opt/cray/pe/dsmml/0.2.2/dsmml/lib', 'SLURM_CLUSTER_NAME': 'perlmutter', 'CRAY_LMOD_MPI': 'cray-mpich/8.0', 'JAVA_BINDIR': '/usr/lib64/jvm/java/bin', 'SLURM_JOB_END_TIME': '1724687912', 'MPICH_GPU_SUPPORT_ENABLED': '1', 'CRAY_CUDATOOLKIT_VERSION': '23.9_12.2', 'MAN_POSIXLY_CORRECT': '1', 'LMOD_ADMIN_FILE': '/opt/nersc/pe/etc/lmod/admin.list', 'LMOD_FAMILY_HARDWARE': 'gpu', 'SLURM_CPUS_ON_NODE': '128', 'GCC_VERSION': '12.3', 'LMOD_FAMILY_HARDWARE_VERSION': '1.0', 'TORCH_CUDA_ARCH_LIST': '5.2 6.0 6.1 7.0 7.2 7.5 8.0 8.6 8.7 9.0+PTX', 'LMOD_RC': '/opt/nersc/pe/etc/lmod/lmodrc.lua', 'PE_LIBSCI_REQUIRED_PRODUCTS': 'PE_MPICH', 'PE_MPICH_PKGCONFIG_LIBS': 'mpich', 'NCCL_VERSION': '2.21.5', 'OFFLOAD_INIT': 'on_start', 'PE_XPMEM_PKGCONFIG_LIBS': 'cray-xpmem', 'PE_MPICH_GTL_LIBS_nvidia90': '-lmpi_gtl_cuda', 'SLURM_JOB_CPUS_PER_NODE': '128', 'CRAY_DSMML_VER': '0.2.2', 'GPG_TTY': '/dev/pts/198', 'NCCL_SOCKET_IFNAME': 'hsn', 'LMOD_DIR': '/opt/cray/pe/lmod/lmod/libexec', 'PE_LIBSCI_PKGCONFIG_LIBS': 'libsci_mpi:libsci', 'NCCL_NET_GDR_LEVEL': 'PHB', 'CRAY_LMOD_NET': 'ofi/1.0', 'CUSPARSE_VERSION': '12.3.1.170', 'ENV': '/etc/shinit_v2', 'SLURM_GPUS_ON_NODE': '4', 'PRTE_MCA_plm_slurm_args': '--external-launcher', 'PWD': '/workspace', 'SLURM_GTIDS': '0', 'LOGNAME': 'lokeshb', 'CRAY_MPICH_ROOTDIR': '/opt/cray/pe/mpich/8.1.28', 'CRAY_CUDATOOLKIT_POST_LINK_OPTS': '-L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64 -Wl,--as-needed,-lcupti,-lcudart,--no-as-needed -lcuda', '__LMOD_REF_COUNT_CRAY_LD_LIBRARY_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:1;/opt/cray/pe/perftools/23.12.0/lib64:1;/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib:1;/opt/cray/pe/mpich/8.1.28/gtl/lib:1;/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64/lib:1;/opt/cray/pe/dsmml/0.2.2/dsmml/lib:1', 'XDG_SESSION_TYPE': 'tty', '__LMOD_REF_COUNT_PE_LIBSCI_REQUIRED_PRODUCTS': 'PE_MPICH:1', 'PE_MPICH_GTL_DIR_nvidia80': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SLURM_JOB_PARTITION': 'gpu_ss11', 'OPENUCX_VERSION': '1.17.0', 'MODULESHOME': '/opt/cray/pe/lmod/lmod', 'NSIGHT_SYSTEMS_VERSION': '2024.2.1.106', 'NVIDIA_DRIVER_CAPABILITIES': 'compute,utility,video', 'CRAY_MPICH_PREFIX': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'MANPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/doc/man:/opt/cray/pe/perftools/23.12.0/man:/opt/cray/pe/papi/7.0.1.2/share/pdoc/man:/opt/cray/pe/craype/2.7.30/man:/opt/cray/pe/mpich/8.1.28/ofi/man:/opt/cray/pe/mpich/8.1.28/man/mpich:/opt/cray/pe/libsci/23.12.5/share/man:/opt/cray/pe/dsmml/0.2.2/dsmml/man:/opt/cray/libfabric/1.15.2.0/share/man:/opt/cray/pe/lmod/lmod/share/man:/usr/local/man:/usr/share/man:/usr/man', 'SLURM_TRES_PER_TASK': 'cpu:32,gres/gpu:1', 'POLYGRAPHY_VERSION': '0.49.10', 'LMOD_CASE_INDEPENDENT_SORTING': 'yes', 'SLURM_JOB_NUM_NODES': '1', 'UCC_CL_BASIC_TLS': '^sharp', '_ModuleTable008_': 'Lip6ZmluYWwiLAp9LApjdWRhdG9vbGtpdCA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9jdWRhdG9vbGtpdC8xMi4yLmx1YSIsCmZ1bGxOYW1lID0gImN1ZGF0b29sa2l0LzEyLjIiLApsb2FkT3JkZXIgPSAxMywKcHJvcFQgPSB7fSwKc3RhY2tEZXB0aCA9IDEsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJjdWRhdG9vbGtpdCIsCndWID0gIl4wMDAwMDAxMi4wMDAwMDAwMDIuKnpmaW5hbCIsCn0sClsiZ2NjLW5hdGl2ZSJdID0gewpmbiA9ICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlL2djYy1uYXRpdmUvMTIuMy5sdWEiLApmdWxsTmFtZSA9ICJnY2MtbmF0aXZlLzEyLjMiLApsb2FkT3JkZXIgPSAxMCwKcHJv', 'PE_DSMML_MODULE_NAME': 'cray-dsmml', 'TZ': 'America/Los_Angeles', 'TRT_VERSION': '10.0.1.6', 'VSCODE_GIT_ASKPASS_NODE': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/node', 'SLURM_JOBID': '29803093', '_ModuleTable013_': 'aWxhbi8xLjAiCiwgIi9vcHQvY3JheS9wZS9tb2R1bGVmaWxlcy9MaW51eCIsICIvb3B0L2NyYXkvcGUvbW9kdWxlZmlsZXMvQ29yZSIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jcmF5cGUtdGFyZ2V0cy9kZWZhdWx0IgosICIvZ2xvYmFsL2NvbW1vbi9zb2Z0d2FyZS9uZXJzYy9wZS9tb2R1bGVmaWxlc19ob3RmaXhlcyIKLCAiL29wdC9uZXJzYy9wZS9tb2R1bGVmaWxlcyIsICIvdXNyL3NoYXJlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlIiwgIi9vcHQvY3JheS9tb2R1bGVmaWxlcyIsCn0sCnN5c3RlbUJh', 'NVIDIA_PRODUCT_NAME': 'PyTorch', 'container': 'podman', 'RDMACORE_VERSION': '39.0', 'NVIDIA_CPU_ONLY': '1', 'I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS': '--external-launcher', 'SLURM_JOB_QOS': 'gpu_debug', 'XKEYSYMDB': '/usr/X11R6/lib/X11/XKeysymDB', 'CRAY_ACCEL_VENDOR': 'nvidia', '__LMOD_REF_COUNT_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/compute-sanitizer:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/bin:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/libnvvp:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Compute:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Systems/bin:1;/opt/cray/pe/perftools/23.12.0/bin:1;/opt/cray/pe/papi/7.0.1.2/bin:1;/opt/cray/pe/craype/2.7.30/bin:1;/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/bin:1;/opt/cray/pe/mpich/8.1.28/bin:1;/opt/cray/libfabric/1.15.2.0/bin:1;/usr/local/bin:1;/usr/bin:1;/bin:1;/usr/lib/mit/bin:1;/opt/cray/pe/bin:1', 'XNLSPATH': '/usr/X11R6/lib/X11/nls', 'HOME': '/global/homes/l/lokeshb', 'PE_MPICH_FIXED_PRGENV': 'GNU', '__LMOD_REF_COUNT_PE_MPICH_GENCOMPILERS_GNU': '12.3:1', 'APP2_STATE': '23.12.0', '_ModuleTable_Sz_': '14', 'CRAY_MPICH_DIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'LANG': 'en_US.UTF-8', 'HUGETLB_VERBOSE': '0', '__LMOD_REF_COUNT_PKG_CONFIG_PATH': '/opt/cray/pe/modulefiles/cudatoolkit:1;/opt/cray/pe/craype/2.7.30/pkg-config:1;/opt/cray/pe/dsmml/0.2.2/dsmml/lib/pkgconfig:1;/opt/cray/libfabric/1.15.2.0/lib64/pkgconfig:1', 'SLURM_PROCID': '0', 'CRAY_LMOD_COMPILER': 'gnu/12.0', '__LMOD_REF_COUNT_PE_GNU_FIXED_PKGCONFIG_PATH': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib/pkgconfig:1', 'CRAY_ACCEL_TARGET': 'nvidia80', 'PE_MPICH_GTL_DIR_amd_gfx942': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SCRATCH': '/pscratch/sd/l/lokeshb', 'COCOAPI_VERSION': '2.0+nv0.8.0', 'PE_MPICH_GTL_DIR_amd_gfx940': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'MPICH_MPIIO_DVS_MAXNODES': '24', 'CUDA_VERSION': '12.4.1.003', 'LMOD_FAMILY_GCC_COMPILER_VERSION': '12.3', '__LMOD_REF_COUNT_CPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include:1', 'LMOD_SETTARG_FULL_SUPPORT': 'no', 'PYTORCH_VERSION': '2.4.0a0+07cecf4', 'CURAND_VERSION': '10.3.5.147', 'OSTYPE': 'linux', 'TMPDIR': '/tmp', 'GIT_ASKPASS': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/extensions/git/dist/askpass.sh', '__lmod_sh_dbg': "'x'", 'PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION': 'python', '_ModuleTable010_': 'MS4xNS4yLjAiLApsb2FkT3JkZXIgPSAyLApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImxpYmZhYnJpYyIsCndWID0gIl4wMDAwMDAwMS4wMDAwMDAwMTUuMDAwMDAwMDAyLip6ZmluYWwiLAp9LApbInBlcmZ0b29scy1iYXNlIl0gPSB7CmZuID0gIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmUvcGVyZnRvb2xzLWJhc2UvMjMuMTIuMC5sdWEiLApmdWxsTmFtZSA9ICJwZXJmdG9vbHMtYmFzZS8yMy4xMi4wIiwKbG9hZE9yZGVyID0gMTEsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAicGVyZnRvb2xzLWJhc2UvMjMuMTIuMCIsCndWID0gIl4w', 'SLURM_CPUS_PER_TASK': '32', 'SLURM_NTASKS': '4', 'PYTORCH_BUILD_NUMBER': '0', 'GNU_VERSION': '12.3', 'LMOD_FAMILY_CRAYPE_NETWORK': 'craype-network-ofi', 'LESS_ADVANCED_PREPROCESSOR': 'no', 'LMOD_FAMILY_GCC_COMPILER': 'gcc-native', 'SLURM_TOPOLOGY_ADDR': 'nid001036', 'LMOD_VERSION': '8.7.31', 'PE_LIBSCI_PKGCONFIG_VARIABLES': 'PE_LIBSCI_OMP_REQUIRES_@openmp@:PE_SCI_EXT_LIBPATH:PE_SCI_EXT_LIBNAME', 'LMOD_FAMILY_CRAYPE_ACCEL': 'craype-accel-nvidia80', 'PODMANHPC_MODULES_DIR': '/etc/podman_hpc/modules.d', 'SSH_CONNECTION': '103.232.241.199 35000 128.55.126.1 22', 'USE_EXPERIMENTAL_CUDNN_V8_API': '1', 'CUTENSOR_VERSION': '2.0.1.2', 'CRAYPAT_LD_LIBRARY_PATH': '/opt/cray/pe/perftools/23.12.0/lib64', 'PIP_DEFAULT_TIMEOUT': '100', 'LMOD_IGNORE_CACHE': '1', 'LMOD_PACKAGE_PATH': '/opt/nersc/pe/etc/lmod/sitepackages', 'PE_GCC_EXTERNAL': 'native', '__LMOD_REF_COUNT_PE_DSMML_PKGCONFIG_LIBS': 'dsmml:1', 'NVFUSER_BUILD_VERSION': '0ff5802', 'CRAY_CPU_TARGET': 'x86-milan', 'HPCX_VERSION': '2.19', 'CRAY_PE_LIBSCI_PREFIX_DIR': '/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64', 'CRAYPE_DIR': '/opt/cray/pe/craype/2.7.30', 'CRAY_XPMEM_INCLUDE_OPTS': '-I/opt/cray/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta/include', '_ModuleTable003_': 'IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNwZSIsCndWID0gIl4wMDAwMDAyMy4wMDAwMDAwMTIuKnpmaW5hbCIsCn0sClsiY3JheS1kc21tbCJdID0gewpmbiA9ICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlL2NyYXktZHNtbWwvMC4yLjIubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1kc21tbC8wLjIuMiIsCmxvYWRPcmRlciA9IDYsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheS1kc21tbC8wLjIuMiIsCndWID0gIl4wMDAwMDAwMC4wMDAwMDAwMDIuMDAwMDAwMDAyLip6ZmluYWwiLAp9LApbImNyYXktbGlic2NpIl0gPSB7CmZuID0gIi9vcHQv', 'HYDRA_BOOTSTRAP': 'slurm', 'MODULEPATH_ROOT': '/opt/cray/pe/modulefiles', 'NVM_DIR': '/usr/local/nvm', 'TORCH_CUDNN_V8_API_ENABLED': '1', 'VSCODE_GIT_ASKPASS_EXTRA_ARGS': '', 'CUDA_VISIBLE_DEVICES': '0,1,2,3', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'PE_MPICH_GTL_LIBS_nvidia80': '-lmpi_gtl_cuda', 'PE_PKGCONFIG_LIBS': 'cudatoolkit_12.2:mpich:libsci_mpi:libsci:dsmml', 'LESSCLOSE': 'lessclose.sh %s %s', 'PE_MPICH_GENCOMPILERS_GNU': '12.3', 'LMOD_FAMILY_CRAYPE_ACCEL_VERSION': 'false', 'XDG_SESSION_CLASS': 'user', 'LMOD_PKG': '/opt/cray/pe/lmod/lmod', 'SLURM_SCRIPT_CONTEXT': 'prolog_task', 'PE_LIBSCI_GENCOMPILERS_GNU_x86_64': '12.3', 'PYTHONPATH': '/opt/nersc/pymon', 'TERM': 'xterm-256color', 'PE_MPICH_GTL_DIR_ponteVecchio': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'LMOD_FAMILY_CRAYPE_CPU_VERSION': 'false', 'G_FILENAME_ENCODING': '@locale,UTF-8,ISO-8859-15,CP1252', 'HOST': 'login15', 'GDRCOPY_VERSION': '2.3.1-1', 'NVFUSER_VERSION': '0ff5802', 'PE_MPICH_FORTRAN_PKGCONFIG_LIBS': 'mpichf90', 'LESSOPEN': 'lessopen.sh %s', 'PE_MPICH_GTL_DIR_nvidia90': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'USER': 'lokeshb', 'CFS': '/global/cfs/cdirs', 'CRAY_DSMML_DIR': '/opt/cray/pe/dsmml/0.2.2/dsmml', 'OPENMPI_VERSION': '4.1.7', 'PE_LIBSCI_VOLATILE_PRGENV': 'GNU', 'LMOD_FAMILY_LIBSCI_VERSION': '23.12.5', 'NVJPEG_VERSION': '12.3.1.117', 'LMOD_FAMILY_CRAYPE_VERSION': '2.7.30', 'LIBRARY_PATH': '/usr/local/cuda/lib64/stubs:', 'SLURM_NODELIST': 'nid001036', '__LMOD_REF_COUNT_PE_MPICH_FORTRAN_PKGCONFIG_LIBS': 'mpichf90:1', 'PE_DSMML_PKGCONFIG_LIBS': 'dsmml', 'VSCODE_GIT_IPC_HANDLE': '/run/user/105785/vscode-git-9051b97600.sock', 'ENVIRONMENT': 'BATCH', 'PYTHONIOENCODING': 'utf-8', 'CRAYPAT_OPTS_EXECUTABLE': 'libexec64/opts', 'PE_MPICH_GTL_LIBS_amd_gfx942': '-lmpi_gtl_hsa', 'CRAYPAT_ROOT': '/opt/cray/pe/perftools/23.12.0', 'PE_MPICH_GTL_LIBS_amd_gfx940': '-lmpi_gtl_hsa', 'MORE': '-sl', 'CRAY_MPICH_VER': '8.1.28', 'LOADEDMODULES': 'craype-x86-milan:libfabric/1.15.2.0:craype-network-ofi:xpmem/2.6.2-2.5_2.38__gd067c3f.shasta:PrgEnv-gnu/8.5.0:cray-dsmml/0.2.2:cray-libsci/23.12.5:cray-mpich/8.1.28:craype/2.7.30:gcc-native/12.3:perftools-base/23.12.0:cpe/23.12:cudatoolkit/12.2:craype-accel-nvidia80:gpu/1.0', 'SLURM_JOB_ACCOUNT': 'm4392_g', 'SLURM_PRIO_PROCESS': '0', 'CSHEDIT': 'emacs', 'PE_LIBSCI_OMP_REQUIRES': ' ', 'CRAY_DSMML_ROOTDIR': '/opt/cray/pe/dsmml/0.2.2', 'NERSC_LMOD_CONFIGDIR': '/opt/nersc/pe/etc/lmod', 'SLURM_NPROCS': '4', 'LMOD_ROOT': '/opt/cray/pe/lmod', 'NVHPC_CUDA_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'SHLVL': '5', '_ModuleTable012_': 'Cn0sCn0sCm1wYXRoQSA9IHsKIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL3BlcmZ0b29scy8yMy4xMi4wIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb21uZXQvZ251LzEyLjAvb2ZpLzEuMCIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvbWl4X2NvbXBpbGVycyIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29tcGlsZXIvZ251LzEyLjAiCiwgIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL21waS9nbnUvMTIuMC9vZmkvMS4wL2NyYXktbXBpY2gvOC4wIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9uZXQvb2ZpLzEuMCIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3B1L3g4Ni1t', 'CRAYPE_NETWORK_TARGET': 'ofi', 'SLURM_NNODES': '1', 'BASH_ENV': '/opt/cray/pe/lmod/lmod/init/bash', '__LMOD_REF_COUNT_PE_MPICH_FIXED_PRGENV': 'GNU:1', 'PE_MPICH_GTL_LIBS_nvidia70': '-lmpi_gtl_cuda', '_ModuleTable006_': 'cmF5cGUtYWNjZWwtbnZpZGlhODAiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUtYWNjZWwtbnZpZGlhODAubHVhIiwKZnVsbE5hbWUgPSAiY3JheXBlLWFjY2VsLW52aWRpYTgwIiwKbG9hZE9yZGVyID0gMTQsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheXBlLWFjY2VsLW52aWRpYTgwIiwKd1YgPSAiTS4qemZpbmFsIiwKfSwKWyJjcmF5cGUtbmV0d29yay1vZmkiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUtbmV0d29yay1vZmkubHVhIiwKZnVs', 'WINDOWMANAGER': 'xterm', 'PAGER': 'less', 'CRAY_TCMALLOC_MEMFS_FORCE': '1', 'CRAYPE_LINK_TYPE': 'dynamic', 'CRAY_DSMML_BASEDIR': '/opt/cray/pe/dsmml/0.2.2', 'LMOD_sys': 'Linux', 'PE_LIBSCI_OMP_REQUIRES_openmp': '_mp', 'PAT_RT_PERFCTR_DISABLE_COMPONENTS': 'nvml,rocm_smi', 'PE_LIBSCI_MODULE_NAME': 'cray-libsci/23.12.5', '__LMOD_REF_COUNT_PE_FORTRAN_PKGCONFIG_LIBS': 'mpichf90:1', 'LIBGL_DEBUG': 'quiet', 'PE_ENV': 'GNU', 'CUDNN_VERSION': '9.1.0.70', '_ModuleTable009_': 'cFQgPSB7fSwKc3RhY2tEZXB0aCA9IDEsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJnY2MtbmF0aXZlLzEyLjMiLAp3ViA9ICJeMDAwMDAwMTIuMDAwMDAwMDAzLip6ZmluYWwiLAp9LApncHUgPSB7CmZuID0gIi9vcHQvbmVyc2MvcGUvbW9kdWxlZmlsZXMvZ3B1LzEuMC5sdWEiLApmdWxsTmFtZSA9ICJncHUvMS4wIiwKbG9hZE9yZGVyID0gMTUsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAwLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiZ3B1IiwKd1YgPSAiMDAwMDAwMDAxLip6ZmluYWwiLAp9LApsaWJmYWJyaWMgPSB7CmZuID0gIi9vcHQvY3JheS9tb2R1bGVmaWxlcy9saWJmYWJyaWMvMS4xNS4yLjAiLApmdWxsTmFtZSA9ICJsaWJmYWJyaWMv', 'PE_MPICH_GTL_LIBS_ponteVecchio': '-lmpi_gtl_ze', 'HDF5_USE_FILE_LOCKING': 'FALSE', 'CRAY_MPICH_VERSION': '8.1.28', '__LMOD_REF_COUNT_MANPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/doc/man:1;/opt/cray/pe/perftools/23.12.0/man:1;/opt/cray/pe/papi/7.0.1.2/share/pdoc/man:1;/opt/cray/pe/craype/2.7.30/man:1;/opt/cray/pe/mpich/8.1.28/ofi/man:1;/opt/cray/pe/mpich/8.1.28/man/mpich:1;/opt/cray/pe/libsci/23.12.5/share/man:1;/opt/cray/pe/dsmml/0.2.2/dsmml/man:1;/opt/cray/libfabric/1.15.2.0/share/man:1;/opt/cray/pe/lmod/lmod/share/man:1;/usr/local/man:1;/usr/share/man:1;/usr/man:1', 'PERFTOOLS_VERSION': '23.12.0', 'XDG_SESSION_ID': '148161', 'NSIGHT_COMPUTE_VERSION': '2024.1.1.4', 'SLURM_SUBMIT_HOST': 'login15', 'DALI_VERSION': '1.37.1', '_ModuleTable001_': 'X01vZHVsZVRhYmxlXyA9IHsKTVR2ZXJzaW9uID0gMywKY19yZWJ1aWxkVGltZSA9IGZhbHNlLApjX3Nob3J0VGltZSA9IGZhbHNlLApkZXB0aFQgPSB7fSwKZmFtaWx5ID0gewpQcmdFbnYgPSAiUHJnRW52LWdudSIsCmNvbXBpbGVyID0gImdjYy1uYXRpdmUiLApjcmF5cGUgPSAiY3JheXBlIiwKY3JheXBlX2FjY2VsID0gImNyYXlwZS1hY2NlbC1udmlkaWE4MCIsCmNyYXlwZV9jcHUgPSAiY3JheXBlLXg4Ni1taWxhbiIsCmNyYXlwZV9uZXR3b3JrID0gImNyYXlwZS1uZXR3b3JrLW9maSIsCmN1ZGF0b29sa2l0ID0gImN1ZGF0b29sa2l0IiwKZ2NjX2NvbXBpbGVyID0gImdjYy1uYXRpdmUiLApoYXJkd2FyZSA9ICJncHUiLApsaWJzY2kgPSAiY3JheS1saWJzY2kiLAptcGkg', 'JUPYTER_PORT': '8888', 'PYTORCH_HOME': '/opt/pytorch/pytorch', 'LD_LIBRARY_PATH': '/usr/local/cuda-12.2/compat:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:/opt/cray/pe/papi/7.0.1.2/lib64:/opt/cray/libfabric/1.15.2.0/lib64:/opt/cray/libfabric/1.15.2.0/lib64', 'LMOD_FAMILY_CRAYPE_NETWORK_VERSION': 'false', 'NVIDIA_BUILD_ID': '91431255', 'LMOD_FAMILY_COMPILER': 'gcc-native', 'XDG_RUNTIME_DIR': '/run/user/105785', '_ModuleTable014_': 'c2VNUEFUSCA9ICIvb3B0L2NyYXkvcGUvbW9kdWxlZmlsZXMvTGludXg6L29wdC9jcmF5L3BlL21vZHVsZWZpbGVzL0NvcmU6L29wdC9jcmF5L3BlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlOi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmU6L29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdDovZ2xvYmFsL2NvbW1vbi9zb2Z0d2FyZS9uZXJzYy9wZS9tb2R1bGVmaWxlc19ob3RmaXhlczovb3B0L25lcnNjL3BlL21vZHVsZWZpbGVzOi91c3Ivc2hhcmUvbG1vZC9sbW9kL21vZHVsZWZpbGVzL0NvcmU6L29wdC9jcmF5L21vZHVsZWZpbGVzIiwKfQo=', 'SLURM_JOB_ID': '29803093', 'PE_MPICH_GTL_DIR_amd_gfx90a': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SLURM_NODEID': '0', '_ModuleTable004_': 'Y3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvbXBpbGVyL2dudS8xMi4wL2NyYXktbGlic2NpLzIzLjEyLjUubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1saWJzY2kvMjMuMTIuNSIsCmxvYWRPcmRlciA9IDcsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheS1saWJzY2kvMjMuMTIuNSIsCndWID0gIl4wMDAwMDAyMy4wMDAwMDAwMTIuMDAwMDAwMDA1Lip6ZmluYWwiLAp9LApbImNyYXktbXBpY2giXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29tbmV0L2dudS8xMi4wL29maS8xLjAvY3JheS1tcGljaC84LjEuMjgubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1tcGljaC84LjEuMjgiLAps', 'LMOD_FAMILY_MPI_VERSION': '8.1.28', 'CRAY_PERFTOOLS_PREFIX': '/opt/cray/pe/perftools/23.12.0', 'LMOD_MODULERCFILE': '/opt/nersc/pe/etc/lmod/modulerc.lua', 'SSH_CLIENT': '103.232.241.199 35000 22', '__lmod_my_status': '$?;', 'OMPI_MCA_coll_hcoll_enable': '0', 'FI_MR_CACHE_MONITOR': 'userfaultfd', 'XTPE_LINK_TYPE': 'dynamic', 'OPAL_PREFIX': '/opt/hpcx/ompi', 'LMOD_FAMILY_MPI': 'cray-mpich', 'CSHRCREAD': 'true', 'LMOD_SYSHOST': 'perlmutter', 'CRAY_MPICH_BASEDIR': '/opt/cray/pe/mpich/8.1.28/ofi', 'CUDA_DRIVER_VERSION': '550.54.15', 'TRANSFORMER_ENGINE_VERSION': '1.6', 'LC_ALL': 'C.UTF-8', 'LMOD_FAMILY_COMPILER_VERSION': '12.3', 'PYTORCH_BUILD_VERSION': '2.4.0a0+07cecf4', '_CUDA_COMPAT_PATH': '/usr/local/cuda/compat', 'VSCODE_GIT_ASKPASS_MAIN': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/extensions/git/dist/askpass-main.js', 'CUDA_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'NERSC_HOST': 'perlmutter', 'CRAY_PERFTOOLS_VERSION': '23.12.0', 'PE_GCC_LEVEL': '12', 'PE_MPICH_GTL_DIR_amd_gfx908': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'PE_MPICH_GTL_DIR_amd_gfx906': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'CUDA_MODULE_LOADING': 'LAZY', 'XDG_DATA_DIRS': '/usr/share', '__LMOD_REF_COUNT_PE_PRODUCT_LIST': 'CRAYPE:1;CRAYPE_X86_MILAN:1;PERFTOOLS:1;CRAYPAT:1;CRAY_HPC_SDK:1;CRAY_ACCEL:1', 'SLURM_JOB_LICENSES': 'u1:1', 'SRUN_CPUS_PER_TASK': '32', 'LMOD_FAMILY_LIBSCI': 'cray-libsci', 'GCC_PREFIX': '/usr/lib64/gcc/x86_64-suse-linux/12', 'NVIDIA_REQUIRE_JETPACK_HOST_MOUNTS': '', 'BROWSER': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/bin/helpers/browser.sh', 'PATH': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/bin/remote-cli:/opt/nersc/pe/bin:/global/common/software/nersc/bin:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/compute-sanitizer:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/bin:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/libnvvp:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Compute:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Systems/bin:/opt/cray/pe/perftools/23.12.0/bin:/opt/cray/pe/papi/7.0.1.2/bin:/opt/cray/pe/craype/2.7.30/bin:/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/bin:/opt/cray/pe/mpich/8.1.28/bin:/opt/cray/libfabric/1.15.2.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/lib/mit/bin:/opt/cray/pe/bin', 'SLURM_JOB_NAME': 'pytorch_distributed_training', 'MODULEPATH': '/opt/cray/pe/lmod/modulefiles/perftools/23.12.0:/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0:/opt/cray/pe/lmod/modulefiles/mix_compilers:/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0:/opt/cray/pe/lmod/modulefiles/mpi/gnu/12.0/ofi/1.0/cray-mpich/8.0:/opt/cray/pe/lmod/modulefiles/net/ofi/1.0:/opt/cray/pe/lmod/modulefiles/cpu/x86-milan/1.0:/opt/cray/pe/modulefiles/Linux:/opt/cray/pe/modulefiles/Core:/opt/cray/pe/lmod/lmod/modulefiles/Core:/opt/cray/pe/lmod/modulefiles/core:/opt/cray/pe/lmod/modulefiles/craype-targets/default:/global/common/software/nersc/pe/modulefiles_hotfixes:/opt/nersc/pe/modulefiles:/usr/share/lmod/lmod/modulefiles/Core:/opt/cray/modulefiles', '__LMOD_REF_COUNT_PE_PKGCONFIG_PRODUCTS': 'PE_MPICH:1;PE_LIBSCI:1;PE_DSMML:1;PE_XPMEM:1', 'SLURM_NTASKS_PER_NODE': '4', '_LMFILES_': '/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-x86-milan.lua:/opt/cray/modulefiles/libfabric/1.15.2.0:/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-network-ofi.lua:/opt/cray/modulefiles/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta:/opt/cray/pe/lmod/modulefiles/core/PrgEnv-gnu/8.5.0.lua:/opt/cray/pe/lmod/modulefiles/core/cray-dsmml/0.2.2.lua:/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0/cray-libsci/23.12.5.lua:/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0/cray-mpich/8.1.28.lua:/opt/cray/pe/lmod/modulefiles/core/craype/2.7.30.lua:/opt/cray/pe/lmod/modulefiles/core/gcc-native/12.3.lua:/opt/cray/pe/lmod/modulefiles/core/perftools-base/23.12.0.lua:/opt/cray/pe/lmod/modulefiles/core/cpe/23.12.lua:/opt/cray/pe/lmod/modulefiles/core/cudatoolkit/12.2.lua:/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-accel-nvidia80.lua:/opt/nersc/pe/modulefiles/gpu/1.0.lua', 'CRAY_CUDATOOLKIT_INCLUDE_OPTS': '-I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include', 'CRAY_CUDATOOLKIT_DIR': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'LMOD_FAMILY_CRAYPE_CPU': 'craype-x86-milan', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/105785/bus', 'PROFILEREAD': 'true', 'LMOD_CMD': '/opt/cray/pe/lmod/lmod/libexec/lmod', 'PE_LIBSCI_VOLATILE_PKGCONFIG_PATH': '/opt/cray/pe/libsci/23.12.5/@PRGENV@/@PE_LIBSCI_GENCOMPS@/@PE_LIBSCI_TARGET@/lib/pkgconfig', 'LMOD_SYSTEM_NAME': 'perlmutter', 'MOFED_VERSION': '5.4-rdmacore39.0', 'MAIL': '/var/spool/mail/lokeshb', 'HOSTTYPE': 'x86_64', '__LMOD_REF_COUNT_LD_LIBRARY_PATH': '/usr/local/cuda-12.2/compat:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:1;/opt/cray/pe/papi/7.0.1.2/lib64:1;/opt/cray/libfabric/1.15.2.0/lib64:1', 'CRAY_DSMML_VERSION': '0.2.2', 'NVIDIA_PYTORCH_VERSION': '24.05', '__LMOD_REF_COUNT_PE_PKGCONFIG_LIBS': 'cudatoolkit_12.2:1;mpich:1;libsci_mpi:1;libsci:1;dsmml:1', 'TRTOSS_VERSION': '24.05', 'LMOD_SYSTEM_DEFAULT_MODULES': 'craype-x86-milan:craype-network-ofi:perftools-base:xpmem:PrgEnv-gnu:cpe:gpu', 'OMPI_MCA_plm_slurm_args': '--external-launcher', 'LMOD_FAMILY_CRAYPE': 'craype', 'SLURM_JOB_GID': '105785', 'CPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include', 'CRAY_PE_LIBSCI_VERSION': '23.12.5', 'LESSKEY': '/etc/lesskey.bin', 'TORCH_ALLOW_TF32_CUBLAS_OVERRIDE': '1', 'CUDATOOLKIT_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'SLURM_JOB_NODELIST': 'nid001036', 'PE_MPICH_MODULE_NAME': 'cray-mpich', 'CRAY_PE_LIBSCI_PREFIX': '/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64', 'LMOD_FAMILY_CUDATOOLKIT_VERSION': '12.2', 'TERM_PROGRAM': 'vscode', 'MPICH_OFI_CXI_COUNTER_REPORT': '0', 'LMOD_FAMILY_CUDATOOLKIT': 'cudatoolkit', 'PE_FORTRAN_PKGCONFIG_LIBS': 'mpichf90', 'I_MPI_HYDRA_BOOTSTRAP': 'slurm', 'VSCODE_IPC_HOOK_CLI': '/run/user/105785/vscode-ipc-1e8eee9c-1197-4c37-8103-958d8969c114.sock', 'PE_MPICH_PKGCONFIG_VARIABLES': 'PE_MPICH_GTL_DIR_@accelerator@:PE_MPICH_GTL_LIBS_@accelerator@', 'LMOD_AVAIL_STYLE': 'grouped:system', 'CUDA_LAUNCH_BLOCKING': '1'})
WORLD_SIZE: 4, GLOBAL_RANK: 0
Traceback (most recent call last):
  File "/workspace/dist-training.py", line 280, in <module>
COUNTER_REPORT': '0', 'LMOD_FAMILY_CUDATOOLKIT': 'cudatoolkit', 'PE_FORTRAN_PKGCONFIG_LIBS': 'mpichf90', 'VSCODE_IPC_HOOK_CLI': '/run/user/105785/vscode-ipc-1e8eee9c-1197-4c37-8103-958d8969c114.sock', 'I_MPI_HYDRA_BOOTSTRAP': 'slurm', 'PE_MPICH_PKGCONFIG_VARIABLES': 'PE_MPICH_GTL_DIR_@accelerator@:PE_MPICH_GTL_LIBS_@accelerator@', 'LMOD_AVAIL_STYLE': 'grouped:system', 'CUDA_LAUNCH_BLOCKING': '1'})
WORLD_SIZE: 4, GLOBAL_RANK: 0
Traceback (most recent call last):
  File "/workspace/dist-training.py", line 280, in <module>
    main(args)
  File "/workspace/dist-training.py", line 263, in main
    main(args)
  File "/workspace/dist-training.py", line 263, in main
    ddp_setup()
  File "/workspace/utils/misc.py", line 50, in ddp_setup
    sync_file = _get_sync_file()
  File "/workspace/utils/misc.py", line 41, in _get_sync_file
    sync_file_dir, os.environ['SLURM_JOB_ID'], os.environ['SLURM_STEP_ID'])
  File "/usr/lib/python3.10/os.py", line 680, in __getitem__
    raise KeyError(key) from None
KeyError: 'SLURM_STEP_ID'
environ({'echo "Shell debugging temporarily silenced: export LMOD_SH_DBG_ON': '1 for Lmod\'s output" 1>&2;', 'BASH_FUNC_module%%': '() {  if [ -z "${LMOD_SH_DBG_ON+x}" ]; then', 'BASH_FUNC_ml%%': '() {  eval "$($LMOD_DIR/ml_cmd "$@")"', 'NPP_VERSION': '12.2.5.30', 'SHELL': '/bin/bash', 'PE_MPICH_GTL_LIBS_amd_gfx90a': '-lmpi_gtl_hsa', 'CRAY_LMOD_CPU': 'x86-milan/1.0', 'LMOD_SITE_NAME': 'NERSC', 'NVIDIA_VISIBLE_DEVICES': 'all', 'GCC_PATH': '/usr/bin', 'COLORTERM': 'truecolor', 'SDK_HOME': '/usr/lib64/jvm/java', 'DALI_BUILD': '14636516', 'SLURM_JOB_USER': 'lokeshb', 'CRAY_DSMML_PREFIX': '/opt/cray/pe/dsmml/0.2.2/dsmml', 'LIBGL_ALWAYS_INDIRECT': '1', 'SLURM_TASKS_PER_NODE': '4', 'XDG_CONFIG_DIRS': '/etc/xdg', 'LESS': '-M -I -R', 'SLURM_JOB_UID': '105785', 'CUSOLVER_VERSION': '11.6.1.9', 'PELOCAL_PRGENV': 'true', 'TERM_PROGRAM_VERSION': '1.92.2', 'JDK_HOME': '/usr/lib64/jvm/java', 'SLURM_TASK_PID': '1609451', 'PE_LIBSCI_GENCOMPS_GNU_x86_64': '123', '__LMOD_REF_COUNT_LMOD_MODULERCFILE': '/opt/cray/pe/cpe/23.12/modulerc.lua:1', 'CRAY_PE_LIBSCI_BASE_DIR': '/opt/cray/pe/libsci/23.12.5', 'CRAYPE_VERSION': '2.7.30', 'CUBLAS_VERSION': '12.4.5.8', 'PE_PRODUCT_LIST': 'CRAYPE:CRAYPE_X86_MILAN:PERFTOOLS:CRAYPAT:CRAY_HPC_SDK:CRAY_ACCEL', 'MACHTYPE': 'x86_64-suse-linux', 'SLURM_JOB_GPUS': '0,1,2,3', 'PKG_CONFIG_PATH': '/opt/cray/pe/modulefiles/cudatoolkit:/opt/cray/pe/craype/2.7.30/pkg-config:/opt/cray/pe/dsmml/0.2.2/dsmml/lib/pkgconfig:/opt/cray/libfabric/1.15.2.0/lib64/pkgconfig', 'SLURM_LOCALID': '0', 'PKGCONFIG_ENABLED': '1', 'SLURM_SUBMIT_DIR': '/global/u1/l/lokeshb/E2E/E2E_MAE_Lokesh_Badisa', 'G_BROKEN_FILENAMES': '1', 'LMOD_FAMILY_PRGENV_VERSION': '8.5.0', 'PE_MPICH_GTL_LIBS_amd_gfx906': '-lmpi_gtl_hsa', 'HISTSIZE': '1000', 'HOSTNAME': 'nid001036', 'FROM_HEADER': '', 'PE_MPICH_GTL_LIBS_amd_gfx908': '-lmpi_gtl_hsa', 'LMOD_CACHED_LOADS': 'no', '__LMOD_REF_COUNT_PE_MPICH_PKGCONFIG_LIBS': 'mpich:1', 'PSCRATCH': '/pscratch/sd/l/lokeshb', 'MINICOM': '-c on', 'SLURMD_NODENAME': 'nid001036', 'CRAY_XPMEM_POST_LINK_OPTS': '-L/opt/cray/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta/lib64', 'LMOD_FAMILY_PRGENV': 'PrgEnv-gnu', '_ModuleTable011_': 'MDAwMDAyMy4wMDAwMDAwMTIuKnpmaW5hbCIsCn0sCnhwbWVtID0gewpmbiA9ICIvb3B0L2NyYXkvbW9kdWxlZmlsZXMveHBtZW0vMi42LjItMi41XzIuMzhfX2dkMDY3YzNmLnNoYXN0YSIsCmZ1bGxOYW1lID0gInhwbWVtLzIuNi4yLTIuNV8yLjM4X19nZDA2N2MzZi5zaGFzdGEiLApsb2FkT3JkZXIgPSA0LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gInhwbWVtIiwKd1YgPSAiXjAwMDAwMDAyLjAwMDAwMDAwNi4wMDAwMDAwMDIuKnpmaW5hbC0uMDAwMDAwMDAyLjAwMDAwMDAwNS4qXy4wMDAwMDAwMDIuMDAwMDAwMDM4LipfLipfLipnZC4wMDAwMDAwNjcuKmMuMDAwMDAwMDAzLipmLipzaGFzdGEuKnpmaW5hbCIs', 'SLURM_JOB_START_TIME': '1724686112', 'PE_GNU_FIXED_PKGCONFIG_PATH': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib/pkgconfig', 'JAVA_ROOT': '/usr/lib64/jvm/java', 'HYDRA_LAUNCHER_EXTRA_ARGS': '--external-launcher', 'JAVA_HOME': '/usr/lib64/jvm/java', 'NVIDIA_REQUIRE_CUDA': 'cuda>=9.0', '_ModuleTable007_': 'bE5hbWUgPSAiY3JheXBlLW5ldHdvcmstb2ZpIiwKbG9hZE9yZGVyID0gMywKcHJvcFQgPSB7fSwKc3RhY2tEZXB0aCA9IDAsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJjcmF5cGUtbmV0d29yay1vZmkiLAp3ViA9ICJNLip6ZmluYWwiLAp9LApbImNyYXlwZS14ODYtbWlsYW4iXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUteDg2LW1pbGFuLmx1YSIsCmZ1bGxOYW1lID0gImNyYXlwZS14ODYtbWlsYW4iLApsb2FkT3JkZXIgPSAxLApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXlwZS14ODYtbWlsYW4iLAp3ViA9ICJN', 'CUFFT_VERSION': '11.2.1.3', 'FI_CXI_RX_MATCH_MODE': 'hybrid', '_ModuleTable002_': 'PSAiY3JheS1tcGljaCIsCn0sCm1UID0gewpbIlByZ0Vudi1nbnUiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9QcmdFbnYtZ251LzguNS4wLmx1YSIsCmZ1bGxOYW1lID0gIlByZ0Vudi1nbnUvOC41LjAiLApsb2FkT3JkZXIgPSA1LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gIlByZ0Vudi1nbnUvOC41LjAiLAp3ViA9ICJeMDAwMDAwMDguMDAwMDAwMDA1Lip6ZmluYWwiLAp9LApjcGUgPSB7CmZuID0gIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmUvY3BlLzIzLjEyLmx1YSIsCmZ1bGxOYW1lID0gImNwZS8yMy4xMiIsCmxvYWRPcmRlciA9IDEyLApwcm9wVCA9', 'JRE_HOME': '/usr/lib64/jvm/java', 'PE_MPICH_GTL_DIR_nvidia70': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'CRAY_CUDATOOLKIT_PREFIX': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'PE_PERFTOOLS_MPICH_LIBDIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib', '__LMOD_REF_COUNT_MODULEPATH': '/opt/cray/pe/lmod/modulefiles/perftools/23.12.0:1;/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0:1;/opt/cray/pe/lmod/modulefiles/mix_compilers:1;/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0:1;/opt/cray/pe/lmod/modulefiles/mpi/gnu/12.0/ofi/1.0/cray-mpich/8.0:1;/opt/cray/pe/lmod/modulefiles/net/ofi/1.0:1;/opt/cray/pe/lmod/modulefiles/cpu/x86-milan/1.0:1;/opt/cray/pe/modulefiles/Linux:1;/opt/cray/pe/modulefiles/Core:1;/opt/cray/pe/lmod/lmod/modulefiles/Core:1;/opt/cray/pe/lmod/modulefiles/core:1;/opt/cray/pe/lmod/modulefiles/craype-targets/default:1;/global/common/software/nersc/pe/modulefiles_hotfixes:1;/opt/nersc/pe/modulefiles:1;/usr/share/lmod/lmod/modulefiles/Core:1;/opt/cray/modulefiles:1', 'SLURM_TRES_BIND': 'gres/gpu:per_task:1', 'PE_PKGCONFIG_PRODUCTS': 'PE_MPICH:PE_LIBSCI:PE_DSMML:PE_XPMEM', 'CPU': 'x86_64', 'MPICH_DIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'CUDA_CACHE_DISABLE': '1', '_ModuleTable005_': 'b2FkT3JkZXIgPSA4LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXktbXBpY2gvOC4xLjI4IiwKd1YgPSAiXjAwMDAwMDA4LjAwMDAwMDAwMS4wMDAwMDAwMjguKnpmaW5hbCIsCn0sCmNyYXlwZSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9jcmF5cGUvMi43LjMwLmx1YSIsCmZ1bGxOYW1lID0gImNyYXlwZS8yLjcuMzAiLApsb2FkT3JkZXIgPSA5LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXlwZS8yLjcuMzAiLAp3ViA9ICJeMDAwMDAwMDIuMDAwMDAwMDA3LjAwMDAwMDAzMC4qemZpbmFsIiwKfSwKWyJj', 'TENSORBOARD_PORT': '6006', 'CRAY_LD_LIBRARY_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:/opt/cray/pe/perftools/23.12.0/lib64:/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib:/opt/cray/pe/mpich/8.1.28/gtl/lib:/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64/lib:/opt/cray/pe/dsmml/0.2.2/dsmml/lib', 'SLURM_CLUSTER_NAME': 'perlmutter', 'CRAY_LMOD_MPI': 'cray-mpich/8.0', 'JAVA_BINDIR': '/usr/lib64/jvm/java/bin', 'SLURM_JOB_END_TIME': '1724687912', 'MPICH_GPU_SUPPORT_ENABLED': '1', 'CRAY_CUDATOOLKIT_VERSION': '23.9_12.2', 'MAN_POSIXLY_CORRECT': '1', 'LMOD_ADMIN_FILE': '/opt/nersc/pe/etc/lmod/admin.list', 'LMOD_FAMILY_HARDWARE': 'gpu', 'SLURM_CPUS_ON_NODE': '128', 'GCC_VERSION': '12.3', 'LMOD_FAMILY_HARDWARE_VERSION': '1.0', 'TORCH_CUDA_ARCH_LIST': '5.2 6.0 6.1 7.0 7.2 7.5 8.0 8.6 8.7 9.0+PTX', 'LMOD_RC': '/opt/nersc/pe/etc/lmod/lmodrc.lua', 'PE_LIBSCI_REQUIRED_PRODUCTS': 'PE_MPICH', 'PE_MPICH_PKGCONFIG_LIBS': 'mpich', 'NCCL_VERSION': '2.21.5', 'OFFLOAD_INIT': 'on_start', 'PE_XPMEM_PKGCONFIG_LIBS': 'cray-xpmem', 'PE_MPICH_GTL_LIBS_nvidia90': '-lmpi_gtl_cuda', 'SLURM_JOB_CPUS_PER_NODE': '128', 'CRAY_DSMML_VER': '0.2.2', 'GPG_TTY': '/dev/pts/198', 'NCCL_SOCKET_IFNAME': 'hsn', 'LMOD_DIR': '/opt/cray/pe/lmod/lmod/libexec', 'PE_LIBSCI_PKGCONFIG_LIBS': 'libsci_mpi:libsci', 'NCCL_NET_GDR_LEVEL': 'PHB', 'CRAY_LMOD_NET': 'ofi/1.0', 'CUSPARSE_VERSION': '12.3.1.170', 'ENV': '/etc/shinit_v2', 'SLURM_GPUS_ON_NODE': '4', 'PRTE_MCA_plm_slurm_args': '--external-launcher', 'PWD': '/workspace', 'SLURM_GTIDS': '0', 'CRAY_MPICH_ROOTDIR': '/opt/cray/pe/mpich/8.1.28', 'LOGNAME': 'lokeshb', 'CRAY_CUDATOOLKIT_POST_LINK_OPTS': '-L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64 -Wl,--as-needed,-lcupti,-lcudart,--no-as-needed -lcuda', '__LMOD_REF_COUNT_CRAY_LD_LIBRARY_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:1;/opt/cray/pe/perftools/23.12.0/lib64:1;/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib:1;/opt/cray/pe/mpich/8.1.28/gtl/lib:1;/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64/lib:1;/opt/cray/pe/dsmml/0.2.2/dsmml/lib:1', 'XDG_SESSION_TYPE': 'tty', '__LMOD_REF_COUNT_PE_LIBSCI_REQUIRED_PRODUCTS': 'PE_MPICH:1', 'PE_MPICH_GTL_DIR_nvidia80': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SLURM_JOB_PARTITION': 'gpu_ss11', 'OPENUCX_VERSION': '1.17.0', 'MODULESHOME': '/opt/cray/pe/lmod/lmod', 'NSIGHT_SYSTEMS_VERSION': '2024.2.1.106', 'NVIDIA_DRIVER_CAPABILITIES': 'compute,utility,video', 'CRAY_MPICH_PREFIX': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'MANPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/doc/man:/opt/cray/pe/perftools/23.12.0/man:/opt/cray/pe/papi/7.0.1.2/share/pdoc/man:/opt/cray/pe/craype/2.7.30/man:/opt/cray/pe/mpich/8.1.28/ofi/man:/opt/cray/pe/mpich/8.1.28/man/mpich:/opt/cray/pe/libsci/23.12.5/share/man:/opt/cray/pe/dsmml/0.2.2/dsmml/man:/opt/cray/libfabric/1.15.2.0/share/man:/opt/cray/pe/lmod/lmod/share/man:/usr/local/man:/usr/share/man:/usr/man', 'SLURM_TRES_PER_TASK': 'cpu:32,gres/gpu:1', 'POLYGRAPHY_VERSION': '0.49.10', 'LMOD_CASE_INDEPENDENT_SORTING': 'yes', 'SLURM_JOB_NUM_NODES': '1', 'UCC_CL_BASIC_TLS': '^sharp', '_ModuleTable008_': 'Lip6ZmluYWwiLAp9LApjdWRhdG9vbGtpdCA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9jdWRhdG9vbGtpdC8xMi4yLmx1YSIsCmZ1bGxOYW1lID0gImN1ZGF0b29sa2l0LzEyLjIiLApsb2FkT3JkZXIgPSAxMywKcHJvcFQgPSB7fSwKc3RhY2tEZXB0aCA9IDEsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJjdWRhdG9vbGtpdCIsCndWID0gIl4wMDAwMDAxMi4wMDAwMDAwMDIuKnpmaW5hbCIsCn0sClsiZ2NjLW5hdGl2ZSJdID0gewpmbiA9ICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlL2djYy1uYXRpdmUvMTIuMy5sdWEiLApmdWxsTmFtZSA9ICJnY2MtbmF0aXZlLzEyLjMiLApsb2FkT3JkZXIgPSAxMCwKcHJv', 'PE_DSMML_MODULE_NAME': 'cray-dsmml', 'TZ': 'America/Los_Angeles', 'TRT_VERSION': '10.0.1.6', 'VSCODE_GIT_ASKPASS_NODE': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/node', 'SLURM_JOBID': '29803093', '_ModuleTable013_': 'aWxhbi8xLjAiCiwgIi9vcHQvY3JheS9wZS9tb2R1bGVmaWxlcy9MaW51eCIsICIvb3B0L2NyYXkvcGUvbW9kdWxlZmlsZXMvQ29yZSIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jcmF5cGUtdGFyZ2V0cy9kZWZhdWx0IgosICIvZ2xvYmFsL2NvbW1vbi9zb2Z0d2FyZS9uZXJzYy9wZS9tb2R1bGVmaWxlc19ob3RmaXhlcyIKLCAiL29wdC9uZXJzYy9wZS9tb2R1bGVmaWxlcyIsICIvdXNyL3NoYXJlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlIiwgIi9vcHQvY3JheS9tb2R1bGVmaWxlcyIsCn0sCnN5c3RlbUJh', 'NVIDIA_PRODUCT_NAME': 'PyTorch', 'container': 'podman', 'RDMACORE_VERSION': '39.0', 'NVIDIA_CPU_ONLY': '1', 'I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS': '--external-launcher', 'SLURM_JOB_QOS': 'gpu_debug', 'XKEYSYMDB': '/usr/X11R6/lib/X11/XKeysymDB', 'CRAY_ACCEL_VENDOR': 'nvidia', '__LMOD_REF_COUNT_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/compute-sanitizer:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/bin:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/libnvvp:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Compute:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Systems/bin:1;/opt/cray/pe/perftools/23.12.0/bin:1;/opt/cray/pe/papi/7.0.1.2/bin:1;/opt/cray/pe/craype/2.7.30/bin:1;/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/bin:1;/opt/cray/pe/mpich/8.1.28/bin:1;/opt/cray/libfabric/1.15.2.0/bin:1;/usr/local/bin:1;/usr/bin:1;/bin:1;/usr/lib/mit/bin:1;/opt/cray/pe/bin:1', 'XNLSPATH': '/usr/X11R6/lib/X11/nls', 'HOME': '/global/homes/l/lokeshb', 'PE_MPICH_FIXED_PRGENV': 'GNU', '__LMOD_REF_COUNT_PE_MPICH_GENCOMPILERS_GNU': '12.3:1', 'APP2_STATE': '23.12.0', '_ModuleTable_Sz_': '14', 'CRAY_MPICH_DIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'LANG': 'en_US.UTF-8', 'HUGETLB_VERBOSE': '0', '__LMOD_REF_COUNT_PKG_CONFIG_PATH': '/opt/cray/pe/modulefiles/cudatoolkit:1;/opt/cray/pe/craype/2.7.30/pkg-config:1;/opt/cray/pe/dsmml/0.2.2/dsmml/lib/pkgconfig:1;/opt/cray/libfabric/1.15.2.0/lib64/pkgconfig:1', 'SLURM_PROCID': '0', 'CRAY_LMOD_COMPILER': 'gnu/12.0', '__LMOD_REF_COUNT_PE_GNU_FIXED_PKGCONFIG_PATH': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib/pkgconfig:1', 'CRAY_ACCEL_TARGET': 'nvidia80', 'PE_MPICH_GTL_DIR_amd_gfx942': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SCRATCH': '/pscratch/sd/l/lokeshb', 'COCOAPI_VERSION': '2.0+nv0.8.0', 'PE_MPICH_GTL_DIR_amd_gfx940': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'MPICH_MPIIO_DVS_MAXNODES': '24', 'CUDA_VERSION': '12.4.1.003', 'LMOD_FAMILY_GCC_COMPILER_VERSION': '12.3', '__LMOD_REF_COUNT_CPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include:1', 'LMOD_SETTARG_FULL_SUPPORT': 'no', 'PYTORCH_VERSION': '2.4.0a0+07cecf4', 'CURAND_VERSION': '10.3.5.147', 'OSTYPE': 'linux', 'TMPDIR': '/tmp', 'GIT_ASKPASS': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/extensions/git/dist/askpass.sh', '__lmod_sh_dbg': "'x'", 'PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION': 'python', '_ModuleTable010_': 'MS4xNS4yLjAiLApsb2FkT3JkZXIgPSAyLApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImxpYmZhYnJpYyIsCndWID0gIl4wMDAwMDAwMS4wMDAwMDAwMTUuMDAwMDAwMDAyLip6ZmluYWwiLAp9LApbInBlcmZ0b29scy1iYXNlIl0gPSB7CmZuID0gIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmUvcGVyZnRvb2xzLWJhc2UvMjMuMTIuMC5sdWEiLApmdWxsTmFtZSA9ICJwZXJmdG9vbHMtYmFzZS8yMy4xMi4wIiwKbG9hZE9yZGVyID0gMTEsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAicGVyZnRvb2xzLWJhc2UvMjMuMTIuMCIsCndWID0gIl4w', 'SLURM_CPUS_PER_TASK': '32', 'PYTORCH_BUILD_NUMBER': '0', 'SLURM_NTASKS': '4', 'GNU_VERSION': '12.3', 'LMOD_FAMILY_CRAYPE_NETWORK': 'craype-network-ofi', 'LESS_ADVANCED_PREPROCESSOR': 'no', 'LMOD_FAMILY_GCC_COMPILER': 'gcc-native', 'SLURM_TOPOLOGY_ADDR': 'nid001036', 'LMOD_VERSION': '8.7.31', 'PE_LIBSCI_PKGCONFIG_VARIABLES': 'PE_LIBSCI_OMP_REQUIRES_@openmp@:PE_SCI_EXT_LIBPATH:PE_SCI_EXT_LIBNAME', 'LMOD_FAMILY_CRAYPE_ACCEL': 'craype-accel-nvidia80', 'PODMANHPC_MODULES_DIR': '/etc/podman_hpc/modules.d', 'SSH_CONNECTION': '103.232.241.199 35000 128.55.126.1 22', 'USE_EXPERIMENTAL_CUDNN_V8_API': '1', 'CUTENSOR_VERSION': '2.0.1.2', 'CRAYPAT_LD_LIBRARY_PATH': '/opt/cray/pe/perftools/23.12.0/lib64', 'PIP_DEFAULT_TIMEOUT': '100', 'LMOD_IGNORE_CACHE': '1', 'LMOD_PACKAGE_PATH': '/opt/nersc/pe/etc/lmod/sitepackages', 'PE_GCC_EXTERNAL': 'native', '__LMOD_REF_COUNT_PE_DSMML_PKGCONFIG_LIBS': 'dsmml:1', 'NVFUSER_BUILD_VERSION': '0ff5802', 'CRAY_CPU_TARGET': 'x86-milan', 'HPCX_VERSION': '2.19', 'CRAY_PE_LIBSCI_PREFIX_DIR': '/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64', 'CRAYPE_DIR': '/opt/cray/pe/craype/2.7.30', 'CRAY_XPMEM_INCLUDE_OPTS': '-I/opt/cray/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta/include', '_ModuleTable003_': 'IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNwZSIsCndWID0gIl4wMDAwMDAyMy4wMDAwMDAwMTIuKnpmaW5hbCIsCn0sClsiY3JheS1kc21tbCJdID0gewpmbiA9ICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlL2NyYXktZHNtbWwvMC4yLjIubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1kc21tbC8wLjIuMiIsCmxvYWRPcmRlciA9IDYsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheS1kc21tbC8wLjIuMiIsCndWID0gIl4wMDAwMDAwMC4wMDAwMDAwMDIuMDAwMDAwMDAyLip6ZmluYWwiLAp9LApbImNyYXktbGlic2NpIl0gPSB7CmZuID0gIi9vcHQv', 'HYDRA_BOOTSTRAP': 'slurm', 'MODULEPATH_ROOT': '/opt/cray/pe/modulefiles', 'NVM_DIR': '/usr/local/nvm', 'TORCH_CUDNN_V8_API_ENABLED': '1', 'VSCODE_GIT_ASKPASS_EXTRA_ARGS': '', 'CUDA_VISIBLE_DEVICES': '0,1,2,3', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'PE_MPICH_GTL_LIBS_nvidia80': '-lmpi_gtl_cuda', 'PE_PKGCONFIG_LIBS': 'cudatoolkit_12.2:mpich:libsci_mpi:libsci:dsmml', 'PE_MPICH_GENCOMPILERS_GNU': '12.3', 'LESSCLOSE': 'lessclose.sh %s %s', 'LMOD_FAMILY_CRAYPE_ACCEL_VERSION': 'false', 'XDG_SESSION_CLASS': 'user', 'LMOD_PKG': '/opt/cray/pe/lmod/lmod', 'SLURM_SCRIPT_CONTEXT': 'prolog_task', 'PE_LIBSCI_GENCOMPILERS_GNU_x86_64': '12.3', 'PYTHONPATH': '/opt/nersc/pymon', 'TERM': 'xterm-256color', 'PE_MPICH_GTL_DIR_ponteVecchio': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'LMOD_FAMILY_CRAYPE_CPU_VERSION': 'false', 'G_FILENAME_ENCODING': '@locale,UTF-8,ISO-8859-15,CP1252', 'HOST': 'login15', 'GDRCOPY_VERSION': '2.3.1-1', 'NVFUSER_VERSION': '0ff5802', 'PE_MPICH_FORTRAN_PKGCONFIG_LIBS': 'mpichf90', 'LESSOPEN': 'lessopen.sh %s', 'PE_MPICH_GTL_DIR_nvidia90': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'USER': 'lokeshb', 'CFS': '/global/cfs/cdirs', 'OPENMPI_VERSION': '4.1.7', 'CRAY_DSMML_DIR': '/opt/cray/pe/dsmml/0.2.2/dsmml', 'PE_LIBSCI_VOLATILE_PRGENV': 'GNU', 'LMOD_FAMILY_LIBSCI_VERSION': '23.12.5', 'LMOD_FAMILY_CRAYPE_VERSION': '2.7.30', 'NVJPEG_VERSION': '12.3.1.117', 'LIBRARY_PATH': '/usr/local/cuda/lib64/stubs:', 'SLURM_NODELIST': 'nid001036', 'PE_DSMML_PKGCONFIG_LIBS': 'dsmml', '__LMOD_REF_COUNT_PE_MPICH_FORTRAN_PKGCONFIG_LIBS': 'mpichf90:1', 'VSCODE_GIT_IPC_HANDLE': '/run/user/105785/vscode-git-9051b97600.sock', 'PYTHONIOENCODING': 'utf-8', 'ENVIRONMENT': 'BATCH', 'CRAYPAT_OPTS_EXECUTABLE': 'libexec64/opts', 'PE_MPICH_GTL_LIBS_amd_gfx942': '-lmpi_gtl_hsa', 'CRAYPAT_ROOT': '/opt/cray/pe/perftools/23.12.0', 'PE_MPICH_GTL_LIBS_amd_gfx940': '-lmpi_gtl_hsa', 'CRAY_MPICH_VER': '8.1.28', 'MORE': '-sl', 'LOADEDMODULES': 'craype-x86-milan:libfabric/1.15.2.0:craype-network-ofi:xpmem/2.6.2-2.5_2.38__gd067c3f.shasta:PrgEnv-gnu/8.5.0:cray-dsmml/0.2.2:cray-libsci/23.12.5:cray-mpich/8.1.28:craype/2.7.30:gcc-native/12.3:perftools-base/23.12.0:cpe/23.12:cudatoolkit/12.2:craype-accel-nvidia80:gpu/1.0', 'SLURM_JOB_ACCOUNT': 'm4392_g', 'CSHEDIT': 'emacs', 'SLURM_PRIO_PROCESS': '0', 'PE_LIBSCI_OMP_REQUIRES': ' ', 'CRAY_DSMML_ROOTDIR': '/opt/cray/pe/dsmml/0.2.2', 'NERSC_LMOD_CONFIGDIR': '/opt/nersc/pe/etc/lmod', 'SLURM_NPROCS': '4', 'LMOD_ROOT': '/opt/cray/pe/lmod', 'NVHPC_CUDA_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'SHLVL': '5', '_ModuleTable012_': 'Cn0sCn0sCm1wYXRoQSA9IHsKIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL3BlcmZ0b29scy8yMy4xMi4wIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb21uZXQvZ251LzEyLjAvb2ZpLzEuMCIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvbWl4X2NvbXBpbGVycyIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29tcGlsZXIvZ251LzEyLjAiCiwgIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL21waS9nbnUvMTIuMC9vZmkvMS4wL2NyYXktbXBpY2gvOC4wIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9uZXQvb2ZpLzEuMCIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3B1L3g4Ni1t', 'CRAYPE_NETWORK_TARGET': 'ofi', 'SLURM_NNODES': '1', 'BASH_ENV': '/opt/cray/pe/lmod/lmod/init/bash', '__LMOD_REF_COUNT_PE_MPICH_FIXED_PRGENV': 'GNU:1', 'PE_MPICH_GTL_LIBS_nvidia70': '-lmpi_gtl_cuda', '_ModuleTable006_': 'cmF5cGUtYWNjZWwtbnZpZGlhODAiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUtYWNjZWwtbnZpZGlhODAubHVhIiwKZnVsbE5hbWUgPSAiY3JheXBlLWFjY2VsLW52aWRpYTgwIiwKbG9hZE9yZGVyID0gMTQsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheXBlLWFjY2VsLW52aWRpYTgwIiwKd1YgPSAiTS4qemZpbmFsIiwKfSwKWyJjcmF5cGUtbmV0d29yay1vZmkiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUtbmV0d29yay1vZmkubHVhIiwKZnVs', 'WINDOWMANAGER': 'xterm', 'PAGER': 'less', 'CRAYPE_LINK_TYPE': 'dynamic', 'CRAY_TCMALLOC_MEMFS_FORCE': '1', 'CRAY_DSMML_BASEDIR': '/opt/cray/pe/dsmml/0.2.2', 'LMOD_sys': 'Linux', 'PE_LIBSCI_OMP_REQUIRES_openmp': '_mp', 'PAT_RT_PERFCTR_DISABLE_COMPONENTS': 'nvml,rocm_smi', 'PE_LIBSCI_MODULE_NAME': 'cray-libsci/23.12.5', '__LMOD_REF_COUNT_PE_FORTRAN_PKGCONFIG_LIBS': 'mpichf90:1', 'LIBGL_DEBUG': 'quiet', 'PE_ENV': 'GNU', 'CUDNN_VERSION': '9.1.0.70', '_ModuleTable009_': 'cFQgPSB7fSwKc3RhY2tEZXB0aCA9IDEsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJnY2MtbmF0aXZlLzEyLjMiLAp3ViA9ICJeMDAwMDAwMTIuMDAwMDAwMDAzLip6ZmluYWwiLAp9LApncHUgPSB7CmZuID0gIi9vcHQvbmVyc2MvcGUvbW9kdWxlZmlsZXMvZ3B1LzEuMC5sdWEiLApmdWxsTmFtZSA9ICJncHUvMS4wIiwKbG9hZE9yZGVyID0gMTUsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAwLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiZ3B1IiwKd1YgPSAiMDAwMDAwMDAxLip6ZmluYWwiLAp9LApsaWJmYWJyaWMgPSB7CmZuID0gIi9vcHQvY3JheS9tb2R1bGVmaWxlcy9saWJmYWJyaWMvMS4xNS4yLjAiLApmdWxsTmFtZSA9ICJsaWJmYWJyaWMv', 'HDF5_USE_FILE_LOCKING': 'FALSE', 'PE_MPICH_GTL_LIBS_ponteVecchio': '-lmpi_gtl_ze', 'CRAY_MPICH_VERSION': '8.1.28', '__LMOD_REF_COUNT_MANPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/doc/man:1;/opt/cray/pe/perftools/23.12.0/man:1;/opt/cray/pe/papi/7.0.1.2/share/pdoc/man:1;/opt/cray/pe/craype/2.7.30/man:1;/opt/cray/pe/mpich/8.1.28/ofi/man:1;/opt/cray/pe/mpich/8.1.28/man/mpich:1;/opt/cray/pe/libsci/23.12.5/share/man:1;/opt/cray/pe/dsmml/0.2.2/dsmml/man:1;/opt/cray/libfabric/1.15.2.0/share/man:1;/opt/cray/pe/lmod/lmod/share/man:1;/usr/local/man:1;/usr/share/man:1;/usr/man:1', 'PERFTOOLS_VERSION': '23.12.0', 'XDG_SESSION_ID': '148161', 'NSIGHT_COMPUTE_VERSION': '2024.1.1.4', 'SLURM_SUBMIT_HOST': 'login15', 'DALI_VERSION': '1.37.1', '_ModuleTable001_': 'X01vZHVsZVRhYmxlXyA9IHsKTVR2ZXJzaW9uID0gMywKY19yZWJ1aWxkVGltZSA9IGZhbHNlLApjX3Nob3J0VGltZSA9IGZhbHNlLApkZXB0aFQgPSB7fSwKZmFtaWx5ID0gewpQcmdFbnYgPSAiUHJnRW52LWdudSIsCmNvbXBpbGVyID0gImdjYy1uYXRpdmUiLApjcmF5cGUgPSAiY3JheXBlIiwKY3JheXBlX2FjY2VsID0gImNyYXlwZS1hY2NlbC1udmlkaWE4MCIsCmNyYXlwZV9jcHUgPSAiY3JheXBlLXg4Ni1taWxhbiIsCmNyYXlwZV9uZXR3b3JrID0gImNyYXlwZS1uZXR3b3JrLW9maSIsCmN1ZGF0b29sa2l0ID0gImN1ZGF0b29sa2l0IiwKZ2NjX2NvbXBpbGVyID0gImdjYy1uYXRpdmUiLApoYXJkd2FyZSA9ICJncHUiLApsaWJzY2kgPSAiY3JheS1saWJzY2kiLAptcGkg', 'JUPYTER_PORT': '8888', 'PYTORCH_HOME': '/opt/pytorch/pytorch', 'LD_LIBRARY_PATH': '/usr/local/cuda-12.2/compat:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:/opt/cray/pe/papi/7.0.1.2/lib64:/opt/cray/libfabric/1.15.2.0/lib64:/opt/cray/libfabric/1.15.2.0/lib64', 'LMOD_FAMILY_CRAYPE_NETWORK_VERSION': 'false', 'NVIDIA_BUILD_ID': '91431255', 'LMOD_FAMILY_COMPILER': 'gcc-native', 'XDG_RUNTIME_DIR': '/run/user/105785', '_ModuleTable014_': 'c2VNUEFUSCA9ICIvb3B0L2NyYXkvcGUvbW9kdWxlZmlsZXMvTGludXg6L29wdC9jcmF5L3BlL21vZHVsZWZpbGVzL0NvcmU6L29wdC9jcmF5L3BlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlOi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmU6L29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdDovZ2xvYmFsL2NvbW1vbi9zb2Z0d2FyZS9uZXJzYy9wZS9tb2R1bGVmaWxlc19ob3RmaXhlczovb3B0L25lcnNjL3BlL21vZHVsZWZpbGVzOi91c3Ivc2hhcmUvbG1vZC9sbW9kL21vZHVsZWZpbGVzL0NvcmU6L29wdC9jcmF5L21vZHVsZWZpbGVzIiwKfQo=', 'SLURM_JOB_ID': '29803093', 'PE_MPICH_GTL_DIR_amd_gfx90a': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SLURM_NODEID': '0', '_ModuleTable004_': 'Y3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvbXBpbGVyL2dudS8xMi4wL2NyYXktbGlic2NpLzIzLjEyLjUubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1saWJzY2kvMjMuMTIuNSIsCmxvYWRPcmRlciA9IDcsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheS1saWJzY2kvMjMuMTIuNSIsCndWID0gIl4wMDAwMDAyMy4wMDAwMDAwMTIuMDAwMDAwMDA1Lip6ZmluYWwiLAp9LApbImNyYXktbXBpY2giXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29tbmV0L2dudS8xMi4wL29maS8xLjAvY3JheS1tcGljaC84LjEuMjgubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1tcGljaC84LjEuMjgiLAps', 'LMOD_FAMILY_MPI_VERSION': '8.1.28', 'CRAY_PERFTOOLS_PREFIX': '/opt/cray/pe/perftools/23.12.0', 'LMOD_MODULERCFILE': '/opt/nersc/pe/etc/lmod/modulerc.lua', 'SSH_CLIENT': '103.232.241.199 35000 22', '__lmod_my_status': '$?;', 'OMPI_MCA_coll_hcoll_enable': '0', 'FI_MR_CACHE_MONITOR': 'userfaultfd', 'XTPE_LINK_TYPE': 'dynamic', 'OPAL_PREFIX': '/opt/hpcx/ompi', 'LMOD_FAMILY_MPI': 'cray-mpich', 'CSHRCREAD': 'true', 'LMOD_SYSHOST': 'perlmutter', 'CRAY_MPICH_BASEDIR': '/opt/cray/pe/mpich/8.1.28/ofi', 'CUDA_DRIVER_VERSION': '550.54.15', 'LC_ALL': 'C.UTF-8', 'TRANSFORMER_ENGINE_VERSION': '1.6', 'LMOD_FAMILY_COMPILER_VERSION': '12.3', 'PYTORCH_BUILD_VERSION': '2.4.0a0+07cecf4', '_CUDA_COMPAT_PATH': '/usr/local/cuda/compat', 'VSCODE_GIT_ASKPASS_MAIN': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/extensions/git/dist/askpass-main.js', 'CUDA_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'NERSC_HOST': 'perlmutter', 'CRAY_PERFTOOLS_VERSION': '23.12.0', 'PE_GCC_LEVEL': '12', 'PE_MPICH_GTL_DIR_amd_gfx908': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'PE_MPICH_GTL_DIR_amd_gfx906': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'CUDA_MODULE_LOADING': 'LAZY', 'XDG_DATA_DIRS': '/usr/share', '__LMOD_REF_COUNT_PE_PRODUCT_LIST': 'CRAYPE:1;CRAYPE_X86_MILAN:1;PERFTOOLS:1;CRAYPAT:1;CRAY_HPC_SDK:1;CRAY_ACCEL:1', 'SLURM_JOB_LICENSES': 'u1:1', 'SRUN_CPUS_PER_TASK': '32', 'LMOD_FAMILY_LIBSCI': 'cray-libsci', 'GCC_PREFIX': '/usr/lib64/gcc/x86_64-suse-linux/12', 'NVIDIA_REQUIRE_JETPACK_HOST_MOUNTS': '', 'BROWSER': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/bin/helpers/browser.sh', 'PATH': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/bin/remote-cli:/opt/nersc/pe/bin:/global/common/software/nersc/bin:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/compute-sanitizer:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/bin:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/libnvvp:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Compute:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Systems/bin:/opt/cray/pe/perftools/23.12.0/bin:/opt/cray/pe/papi/7.0.1.2/bin:/opt/cray/pe/craype/2.7.30/bin:/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/bin:/opt/cray/pe/mpich/8.1.28/bin:/opt/cray/libfabric/1.15.2.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/lib/mit/bin:/opt/cray/pe/bin', 'SLURM_JOB_NAME': 'pytorch_distributed_training', 'MODULEPATH': '/opt/cray/pe/lmod/modulefiles/perftools/23.12.0:/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0:/opt/cray/pe/lmod/modulefiles/mix_compilers:/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0:/opt/cray/pe/lmod/modulefiles/mpi/gnu/12.0/ofi/1.0/cray-mpich/8.0:/opt/cray/pe/lmod/modulefiles/net/ofi/1.0:/opt/cray/pe/lmod/modulefiles/cpu/x86-milan/1.0:/opt/cray/pe/modulefiles/Linux:/opt/cray/pe/modulefiles/Core:/opt/cray/pe/lmod/lmod/modulefiles/Core:/opt/cray/pe/lmod/modulefiles/core:/opt/cray/pe/lmod/modulefiles/craype-targets/default:/global/common/software/nersc/pe/modulefiles_hotfixes:/opt/nersc/pe/modulefiles:/usr/share/lmod/lmod/modulefiles/Core:/opt/cray/modulefiles', '__LMOD_REF_COUNT_PE_PKGCONFIG_PRODUCTS': 'PE_MPICH:1;PE_LIBSCI:1;PE_DSMML:1;PE_XPMEM:1', 'SLURM_NTASKS_PER_NODE': '4', '_LMFILES_': '/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-x86-milan.lua:/opt/cray/modulefiles/libfabric/1.15.2.0:/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-network-ofi.lua:/opt/cray/modulefiles/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta:/opt/cray/pe/lmod/modulefiles/core/PrgEnv-gnu/8.5.0.lua:/opt/cray/pe/lmod/modulefiles/core/cray-dsmml/0.2.2.lua:/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0/cray-libsci/23.12.5.lua:/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0/cray-mpich/8.1.28.lua:/opt/cray/pe/lmod/modulefiles/core/craype/2.7.30.lua:/opt/cray/pe/lmod/modulefiles/core/gcc-native/12.3.lua:/opt/cray/pe/lmod/modulefiles/core/perftools-base/23.12.0.lua:/opt/cray/pe/lmod/modulefiles/core/cpe/23.12.lua:/opt/cray/pe/lmod/modulefiles/core/cudatoolkit/12.2.lua:/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-accel-nvidia80.lua:/opt/nersc/pe/modulefiles/gpu/1.0.lua', 'CRAY_CUDATOOLKIT_INCLUDE_OPTS': '-I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include', 'LMOD_FAMILY_CRAYPE_CPU': 'craype-x86-milan', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/105785/bus', 'CRAY_CUDATOOLKIT_DIR': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'PROFILEREAD': 'true', 'LMOD_CMD': '/opt/cray/pe/lmod/lmod/libexec/lmod', 'PE_LIBSCI_VOLATILE_PKGCONFIG_PATH': '/opt/cray/pe/libsci/23.12.5/@PRGENV@/@PE_LIBSCI_GENCOMPS@/@PE_LIBSCI_TARGET@/lib/pkgconfig', 'LMOD_SYSTEM_NAME': 'perlmutter', 'MOFED_VERSION': '5.4-rdmacore39.0', 'MAIL': '/var/spool/mail/lokeshb', 'HOSTTYPE': 'x86_64', '__LMOD_REF_COUNT_LD_LIBRARY_PATH': '/usr/local/cuda-12.2/compat:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:1;/opt/cray/pe/papi/7.0.1.2/lib64:1;/opt/cray/libfabric/1.15.2.0/lib64:1', 'CRAY_DSMML_VERSION': '0.2.2', 'NVIDIA_PYTORCH_VERSION': '24.05', '__LMOD_REF_COUNT_PE_PKGCONFIG_LIBS': 'cudatoolkit_12.2:1;mpich:1;libsci_mpi:1;libsci:1;dsmml:1', 'TRTOSS_VERSION': '24.05', 'LMOD_SYSTEM_DEFAULT_MODULES': 'craype-x86-milan:craype-network-ofi:perftools-base:xpmem:PrgEnv-gnu:cpe:gpu', 'OMPI_MCA_plm_slurm_args': '--external-launcher', 'LMOD_FAMILY_CRAYPE': 'craype', 'SLURM_JOB_GID': '105785', 'CPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include', 'CRAY_PE_LIBSCI_VERSION': '23.12.5', 'TORCH_ALLOW_TF32_CUBLAS_OVERRIDE': '1', 'LESSKEY': '/etc/lesskey.bin', 'CUDATOOLKIT_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'SLURM_JOB_NODELIST': 'nid001036', 'PE_MPICH_MODULE_NAME': 'cray-mpich', 'CRAY_PE_LIBSCI_PREFIX': '/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64', 'LMOD_FAMILY_CUDATOOLKIT_VERSION': '12.2', 'MPICH_OFI_CXI_COUNTER_REPORT': '0', 'TERM_PROGRAM': 'vscode', 'LMOD_FAMILY_CUDATOOLKIT': 'cudatoolkit', 'VSCODE_IPC_HOOK_CLI': '/run/user/105785/vscode-ipc-1e8eee9c-1197-4c37-8103-958d8969c114.sock', 'I_MPI_HYDRA_BOOTSTRAP': 'slurm', 'PE_FORTRAN_PKGCONFIG_LIBS': 'mpichf90', 'LMOD_AVAIL_STYLE': 'grouped:system', 'PE_MPICH_PKGCONFIG_VARIABLES': 'PE_MPICH_GTL_DIR_@accelerator@:PE_MPICH_GTL_LIBS_@accelerator@', 'CUDA_LAUNCH_BLOCKING': '1'})
WORLD_SIZE: 4, GLOBAL_RANK: 0
Traceback (most recent call last):
  File "/workspace/dist-training.py", line 280, in <module>
    main(args)
  File "/workspace/dist-training.py", line 263, in main
environ({'echo "Shell debugging temporarily silenced: export LMOD_SH_DBG_ON': '1 for Lmod\'s output" 1>&2;', 'BASH_FUNC_module%%': '() {  if [ -z "${LMOD_SH_DBG_ON+x}" ]; then', 'BASH_FUNC_ml%%': '() {  eval "$($LMOD_DIR/ml_cmd "$@")"', 'NPP_VERSION': '12.2.5.30', 'SHELL': '/bin/bash', 'PE_MPICH_GTL_LIBS_amd_gfx90a': '-lmpi_gtl_hsa', 'CRAY_LMOD_CPU': 'x86-milan/1.0', 'LMOD_SITE_NAME': 'NERSC', 'NVIDIA_VISIBLE_DEVICES': 'all', 'COLORTERM': 'truecolor', 'GCC_PATH': '/usr/bin', 'SDK_HOME': '/usr/lib64/jvm/java', 'DALI_BUILD': '14636516', 'SLURM_JOB_USER': 'lokeshb', 'CRAY_DSMML_PREFIX': '/opt/cray/pe/dsmml/0.2.2/dsmml', 'LIBGL_ALWAYS_INDIRECT': '1', 'SLURM_TASKS_PER_NODE': '4', 'XDG_CONFIG_DIRS': '/etc/xdg', 'LESS': '-M -I -R', 'SLURM_JOB_UID': '105785', 'CUSOLVER_VERSION': '11.6.1.9', 'PELOCAL_PRGENV': 'true', 'TERM_PROGRAM_VERSION': '1.92.2', 'JDK_HOME': '/usr/lib64/jvm/java', 'SLURM_TASK_PID': '1609451', 'PE_LIBSCI_GENCOMPS_GNU_x86_64': '123', '__LMOD_REF_COUNT_LMOD_MODULERCFILE': '/opt/cray/pe/cpe/23.12/modulerc.lua:1', 'CRAY_PE_LIBSCI_BASE_DIR': '/opt/cray/pe/libsci/23.12.5', 'CRAYPE_VERSION': '2.7.30', 'CUBLAS_VERSION': '12.4.5.8', 'PE_PRODUCT_LIST': 'CRAYPE:CRAYPE_X86_MILAN:PERFTOOLS:CRAYPAT:CRAY_HPC_SDK:CRAY_ACCEL', 'MACHTYPE': 'x86_64-suse-linux', 'PKG_CONFIG_PATH': '/opt/cray/pe/modulefiles/cudatoolkit:/opt/cray/pe/craype/2.7.30/pkg-config:/opt/cray/pe/dsmml/0.2.2/dsmml/lib/pkgconfig:/opt/cray/libfabric/1.15.2.0/lib64/pkgconfig', 'SLURM_JOB_GPUS': '0,1,2,3', 'SLURM_LOCALID': '0', 'PKGCONFIG_ENABLED': '1', 'SLURM_SUBMIT_DIR': '/global/u1/l/lokeshb/E2E/E2E_MAE_Lokesh_Badisa', 'G_BROKEN_FILENAMES': '1', 'LMOD_FAMILY_PRGENV_VERSION': '8.5.0', 'PE_MPICH_GTL_LIBS_amd_gfx906': '-lmpi_gtl_hsa', 'HOSTNAME': 'nid001036', 'HISTSIZE': '1000', 'FROM_HEADER': '', 'PE_MPICH_GTL_LIBS_amd_gfx908': '-lmpi_gtl_hsa', 'LMOD_CACHED_LOADS': 'no', 'MINICOM': '-c on', '__LMOD_REF_COUNT_PE_MPICH_PKGCONFIG_LIBS': 'mpich:1', 'PSCRATCH': '/pscratch/sd/l/lokeshb', 'SLURMD_NODENAME': 'nid001036', 'CRAY_XPMEM_POST_LINK_OPTS': '-L/opt/cray/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta/lib64', 'SLURM_JOB_START_TIME': '1724686112', '_ModuleTable011_': 'MDAwMDAyMy4wMDAwMDAwMTIuKnpmaW5hbCIsCn0sCnhwbWVtID0gewpmbiA9ICIvb3B0L2NyYXkvbW9kdWxlZmlsZXMveHBtZW0vMi42LjItMi41XzIuMzhfX2dkMDY3YzNmLnNoYXN0YSIsCmZ1bGxOYW1lID0gInhwbWVtLzIuNi4yLTIuNV8yLjM4X19nZDA2N2MzZi5zaGFzdGEiLApsb2FkT3JkZXIgPSA0LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gInhwbWVtIiwKd1YgPSAiXjAwMDAwMDAyLjAwMDAwMDAwNi4wMDAwMDAwMDIuKnpmaW5hbC0uMDAwMDAwMDAyLjAwMDAwMDAwNS4qXy4wMDAwMDAwMDIuMDAwMDAwMDM4LipfLipfLipnZC4wMDAwMDAwNjcuKmMuMDAwMDAwMDAzLipmLipzaGFzdGEuKnpmaW5hbCIs', 'LMOD_FAMILY_PRGENV': 'PrgEnv-gnu', 'PE_GNU_FIXED_PKGCONFIG_PATH': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib/pkgconfig', 'JAVA_ROOT': '/usr/lib64/jvm/java', 'HYDRA_LAUNCHER_EXTRA_ARGS': '--external-launcher', 'JAVA_HOME': '/usr/lib64/jvm/java', 'NVIDIA_REQUIRE_CUDA': 'cuda>=9.0', 'CUFFT_VERSION': '11.2.1.3', '_ModuleTable007_': 'bE5hbWUgPSAiY3JheXBlLW5ldHdvcmstb2ZpIiwKbG9hZE9yZGVyID0gMywKcHJvcFQgPSB7fSwKc3RhY2tEZXB0aCA9IDAsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJjcmF5cGUtbmV0d29yay1vZmkiLAp3ViA9ICJNLip6ZmluYWwiLAp9LApbImNyYXlwZS14ODYtbWlsYW4iXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUteDg2LW1pbGFuLmx1YSIsCmZ1bGxOYW1lID0gImNyYXlwZS14ODYtbWlsYW4iLApsb2FkT3JkZXIgPSAxLApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXlwZS14ODYtbWlsYW4iLAp3ViA9ICJN', 'FI_CXI_RX_MATCH_MODE': 'hybrid', '_ModuleTable002_': 'PSAiY3JheS1tcGljaCIsCn0sCm1UID0gewpbIlByZ0Vudi1nbnUiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9QcmdFbnYtZ251LzguNS4wLmx1YSIsCmZ1bGxOYW1lID0gIlByZ0Vudi1nbnUvOC41LjAiLApsb2FkT3JkZXIgPSA1LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gIlByZ0Vudi1nbnUvOC41LjAiLAp3ViA9ICJeMDAwMDAwMDguMDAwMDAwMDA1Lip6ZmluYWwiLAp9LApjcGUgPSB7CmZuID0gIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmUvY3BlLzIzLjEyLmx1YSIsCmZ1bGxOYW1lID0gImNwZS8yMy4xMiIsCmxvYWRPcmRlciA9IDEyLApwcm9wVCA9', 'JRE_HOME': '/usr/lib64/jvm/java', 'PE_MPICH_GTL_DIR_nvidia70': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'CRAY_CUDATOOLKIT_PREFIX': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'PE_PERFTOOLS_MPICH_LIBDIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib', '__LMOD_REF_COUNT_MODULEPATH': '/opt/cray/pe/lmod/modulefiles/perftools/23.12.0:1;/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0:1;/opt/cray/pe/lmod/modulefiles/mix_compilers:1;/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0:1;/opt/cray/pe/lmod/modulefiles/mpi/gnu/12.0/ofi/1.0/cray-mpich/8.0:1;/opt/cray/pe/lmod/modulefiles/net/ofi/1.0:1;/opt/cray/pe/lmod/modulefiles/cpu/x86-milan/1.0:1;/opt/cray/pe/modulefiles/Linux:1;/opt/cray/pe/modulefiles/Core:1;/opt/cray/pe/lmod/lmod/modulefiles/Core:1;/opt/cray/pe/lmod/modulefiles/core:1;/opt/cray/pe/lmod/modulefiles/craype-targets/default:1;/global/common/software/nersc/pe/modulefiles_hotfixes:1;/opt/nersc/pe/modulefiles:1;/usr/share/lmod/lmod/modulefiles/Core:1;/opt/cray/modulefiles:1', 'SLURM_TRES_BIND': 'gres/gpu:per_task:1', 'PE_PKGCONFIG_PRODUCTS': 'PE_MPICH:PE_LIBSCI:PE_DSMML:PE_XPMEM', 'CPU': 'x86_64', 'MPICH_DIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'CUDA_CACHE_DISABLE': '1', '_ModuleTable005_': 'b2FkT3JkZXIgPSA4LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXktbXBpY2gvOC4xLjI4IiwKd1YgPSAiXjAwMDAwMDA4LjAwMDAwMDAwMS4wMDAwMDAwMjguKnpmaW5hbCIsCn0sCmNyYXlwZSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9jcmF5cGUvMi43LjMwLmx1YSIsCmZ1bGxOYW1lID0gImNyYXlwZS8yLjcuMzAiLApsb2FkT3JkZXIgPSA5LApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNyYXlwZS8yLjcuMzAiLAp3ViA9ICJeMDAwMDAwMDIuMDAwMDAwMDA3LjAwMDAwMDAzMC4qemZpbmFsIiwKfSwKWyJj', 'TENSORBOARD_PORT': '6006', 'CRAY_LD_LIBRARY_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:/opt/cray/pe/perftools/23.12.0/lib64:/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib:/opt/cray/pe/mpich/8.1.28/gtl/lib:/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64/lib:/opt/cray/pe/dsmml/0.2.2/dsmml/lib', 'SLURM_CLUSTER_NAME': 'perlmutter', 'CRAY_LMOD_MPI': 'cray-mpich/8.0', 'JAVA_BINDIR': '/usr/lib64/jvm/java/bin', 'SLURM_JOB_END_TIME': '1724687912', 'MPICH_GPU_SUPPORT_ENABLED': '1', 'MAN_POSIXLY_CORRECT': '1', 'CRAY_CUDATOOLKIT_VERSION': '23.9_12.2', 'LMOD_ADMIN_FILE': '/opt/nersc/pe/etc/lmod/admin.list', 'SLURM_CPUS_ON_NODE': '128', 'LMOD_FAMILY_HARDWARE': 'gpu', 'GCC_VERSION': '12.3', 'LMOD_FAMILY_HARDWARE_VERSION': '1.0', 'TORCH_CUDA_ARCH_LIST': '5.2 6.0 6.1 7.0 7.2 7.5 8.0 8.6 8.7 9.0+PTX', 'LMOD_RC': '/opt/nersc/pe/etc/lmod/lmodrc.lua', 'PE_LIBSCI_REQUIRED_PRODUCTS': 'PE_MPICH', 'PE_MPICH_PKGCONFIG_LIBS': 'mpich', 'NCCL_VERSION': '2.21.5', 'OFFLOAD_INIT': 'on_start', 'PE_MPICH_GTL_LIBS_nvidia90': '-lmpi_gtl_cuda', 'PE_XPMEM_PKGCONFIG_LIBS': 'cray-xpmem', 'SLURM_JOB_CPUS_PER_NODE': '128', 'CRAY_DSMML_VER': '0.2.2', 'GPG_TTY': '/dev/pts/198', 'NCCL_SOCKET_IFNAME': 'hsn', 'LMOD_DIR': '/opt/cray/pe/lmod/lmod/libexec', 'PE_LIBSCI_PKGCONFIG_LIBS': 'libsci_mpi:libsci', 'NCCL_NET_GDR_LEVEL': 'PHB', 'CRAY_LMOD_NET': 'ofi/1.0', 'CUSPARSE_VERSION': '12.3.1.170', 'ENV': '/etc/shinit_v2', 'SLURM_GPUS_ON_NODE': '4', 'PWD': '/workspace', 'PRTE_MCA_plm_slurm_args': '--external-launcher', 'SLURM_GTIDS': '0', 'CRAY_MPICH_ROOTDIR': '/opt/cray/pe/mpich/8.1.28', 'LOGNAME': 'lokeshb', 'CRAY_CUDATOOLKIT_POST_LINK_OPTS': '-L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64 -L/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64 -Wl,--as-needed,-lcupti,-lcudart,--no-as-needed -lcuda', '__LMOD_REF_COUNT_CRAY_LD_LIBRARY_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:1;/opt/cray/pe/perftools/23.12.0/lib64:1;/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib:1;/opt/cray/pe/mpich/8.1.28/gtl/lib:1;/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64/lib:1;/opt/cray/pe/dsmml/0.2.2/dsmml/lib:1', 'XDG_SESSION_TYPE': 'tty', '__LMOD_REF_COUNT_PE_LIBSCI_REQUIRED_PRODUCTS': 'PE_MPICH:1', 'PE_MPICH_GTL_DIR_nvidia80': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SLURM_JOB_PARTITION': 'gpu_ss11', 'OPENUCX_VERSION': '1.17.0', 'MODULESHOME': '/opt/cray/pe/lmod/lmod', 'NSIGHT_SYSTEMS_VERSION': '2024.2.1.106', 'NVIDIA_DRIVER_CAPABILITIES': 'compute,utility,video', 'CRAY_MPICH_PREFIX': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'MANPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/doc/man:/opt/cray/pe/perftools/23.12.0/man:/opt/cray/pe/papi/7.0.1.2/share/pdoc/man:/opt/cray/pe/craype/2.7.30/man:/opt/cray/pe/mpich/8.1.28/ofi/man:/opt/cray/pe/mpich/8.1.28/man/mpich:/opt/cray/pe/libsci/23.12.5/share/man:/opt/cray/pe/dsmml/0.2.2/dsmml/man:/opt/cray/libfabric/1.15.2.0/share/man:/opt/cray/pe/lmod/lmod/share/man:/usr/local/man:/usr/share/man:/usr/man', 'SLURM_TRES_PER_TASK': 'cpu:32,gres/gpu:1', 'POLYGRAPHY_VERSION': '0.49.10', 'LMOD_CASE_INDEPENDENT_SORTING': 'yes', 'SLURM_JOB_NUM_NODES': '1', 'UCC_CL_BASIC_TLS': '^sharp', '_ModuleTable008_': 'Lip6ZmluYWwiLAp9LApjdWRhdG9vbGtpdCA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29yZS9jdWRhdG9vbGtpdC8xMi4yLmx1YSIsCmZ1bGxOYW1lID0gImN1ZGF0b29sa2l0LzEyLjIiLApsb2FkT3JkZXIgPSAxMywKcHJvcFQgPSB7fSwKc3RhY2tEZXB0aCA9IDEsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJjdWRhdG9vbGtpdCIsCndWID0gIl4wMDAwMDAxMi4wMDAwMDAwMDIuKnpmaW5hbCIsCn0sClsiZ2NjLW5hdGl2ZSJdID0gewpmbiA9ICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlL2djYy1uYXRpdmUvMTIuMy5sdWEiLApmdWxsTmFtZSA9ICJnY2MtbmF0aXZlLzEyLjMiLApsb2FkT3JkZXIgPSAxMCwKcHJv', 'PE_DSMML_MODULE_NAME': 'cray-dsmml', 'TZ': 'America/Los_Angeles', 'TRT_VERSION': '10.0.1.6', 'VSCODE_GIT_ASKPASS_NODE': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/node', 'SLURM_JOBID': '29803093', '_ModuleTable013_': 'aWxhbi8xLjAiCiwgIi9vcHQvY3JheS9wZS9tb2R1bGVmaWxlcy9MaW51eCIsICIvb3B0L2NyYXkvcGUvbW9kdWxlZmlsZXMvQ29yZSIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jcmF5cGUtdGFyZ2V0cy9kZWZhdWx0IgosICIvZ2xvYmFsL2NvbW1vbi9zb2Z0d2FyZS9uZXJzYy9wZS9tb2R1bGVmaWxlc19ob3RmaXhlcyIKLCAiL29wdC9uZXJzYy9wZS9tb2R1bGVmaWxlcyIsICIvdXNyL3NoYXJlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlIiwgIi9vcHQvY3JheS9tb2R1bGVmaWxlcyIsCn0sCnN5c3RlbUJh', 'NVIDIA_PRODUCT_NAME': 'PyTorch', 'container': 'podman', 'RDMACORE_VERSION': '39.0', 'NVIDIA_CPU_ONLY': '1', 'SLURM_JOB_QOS': 'gpu_debug', 'I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS': '--external-launcher', 'XKEYSYMDB': '/usr/X11R6/lib/X11/XKeysymDB', 'CRAY_ACCEL_VENDOR': 'nvidia', 'XNLSPATH': '/usr/X11R6/lib/X11/nls', '__LMOD_REF_COUNT_PATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/compute-sanitizer:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/bin:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/libnvvp:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Compute:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Systems/bin:1;/opt/cray/pe/perftools/23.12.0/bin:1;/opt/cray/pe/papi/7.0.1.2/bin:1;/opt/cray/pe/craype/2.7.30/bin:1;/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/bin:1;/opt/cray/pe/mpich/8.1.28/bin:1;/opt/cray/libfabric/1.15.2.0/bin:1;/usr/local/bin:1;/usr/bin:1;/bin:1;/usr/lib/mit/bin:1;/opt/cray/pe/bin:1', 'HOME': '/global/homes/l/lokeshb', 'PE_MPICH_FIXED_PRGENV': 'GNU', '__LMOD_REF_COUNT_PE_MPICH_GENCOMPILERS_GNU': '12.3:1', 'APP2_STATE': '23.12.0', '_ModuleTable_Sz_': '14', 'CRAY_MPICH_DIR': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3', 'LANG': 'en_US.UTF-8', 'HUGETLB_VERBOSE': '0', '__LMOD_REF_COUNT_PKG_CONFIG_PATH': '/opt/cray/pe/modulefiles/cudatoolkit:1;/opt/cray/pe/craype/2.7.30/pkg-config:1;/opt/cray/pe/dsmml/0.2.2/dsmml/lib/pkgconfig:1;/opt/cray/libfabric/1.15.2.0/lib64/pkgconfig:1', 'SLURM_PROCID': '0', 'CRAY_LMOD_COMPILER': 'gnu/12.0', '__LMOD_REF_COUNT_PE_GNU_FIXED_PKGCONFIG_PATH': '/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/lib/pkgconfig:1', 'CRAY_ACCEL_TARGET': 'nvidia80', 'PE_MPICH_GTL_DIR_amd_gfx942': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SCRATCH': '/pscratch/sd/l/lokeshb', 'PE_MPICH_GTL_DIR_amd_gfx940': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'COCOAPI_VERSION': '2.0+nv0.8.0', 'MPICH_MPIIO_DVS_MAXNODES': '24', 'CUDA_VERSION': '12.4.1.003', 'LMOD_FAMILY_GCC_COMPILER_VERSION': '12.3', '__LMOD_REF_COUNT_CPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include:1', 'LMOD_SETTARG_FULL_SUPPORT': 'no', 'PYTORCH_VERSION': '2.4.0a0+07cecf4', 'CURAND_VERSION': '10.3.5.147', 'OSTYPE': 'linux', 'TMPDIR': '/tmp', 'GIT_ASKPASS': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/extensions/git/dist/askpass.sh', '__lmod_sh_dbg': "'x'", 'PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION': 'python', '_ModuleTable010_': 'MS4xNS4yLjAiLApsb2FkT3JkZXIgPSAyLApwcm9wVCA9IHt9LApzdGFja0RlcHRoID0gMSwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImxpYmZhYnJpYyIsCndWID0gIl4wMDAwMDAwMS4wMDAwMDAwMTUuMDAwMDAwMDAyLip6ZmluYWwiLAp9LApbInBlcmZ0b29scy1iYXNlIl0gPSB7CmZuID0gIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmUvcGVyZnRvb2xzLWJhc2UvMjMuMTIuMC5sdWEiLApmdWxsTmFtZSA9ICJwZXJmdG9vbHMtYmFzZS8yMy4xMi4wIiwKbG9hZE9yZGVyID0gMTEsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAicGVyZnRvb2xzLWJhc2UvMjMuMTIuMCIsCndWID0gIl4w', 'SLURM_CPUS_PER_TASK': '32', 'SLURM_NTASKS': '4', 'PYTORCH_BUILD_NUMBER': '0', 'GNU_VERSION': '12.3', 'LMOD_FAMILY_CRAYPE_NETWORK': 'craype-network-ofi', 'LESS_ADVANCED_PREPROCESSOR': 'no', 'LMOD_FAMILY_GCC_COMPILER': 'gcc-native', 'SLURM_TOPOLOGY_ADDR': 'nid001036', 'LMOD_VERSION': '8.7.31', 'PE_LIBSCI_PKGCONFIG_VARIABLES': 'PE_LIBSCI_OMP_REQUIRES_@openmp@:PE_SCI_EXT_LIBPATH:PE_SCI_EXT_LIBNAME', 'LMOD_FAMILY_CRAYPE_ACCEL': 'craype-accel-nvidia80', 'PODMANHPC_MODULES_DIR': '/etc/podman_hpc/modules.d', 'SSH_CONNECTION': '103.232.241.199 35000 128.55.126.1 22', 'USE_EXPERIMENTAL_CUDNN_V8_API': '1', 'CUTENSOR_VERSION': '2.0.1.2', 'CRAYPAT_LD_LIBRARY_PATH': '/opt/cray/pe/perftools/23.12.0/lib64', 'PIP_DEFAULT_TIMEOUT': '100', 'LMOD_IGNORE_CACHE': '1', 'LMOD_PACKAGE_PATH': '/opt/nersc/pe/etc/lmod/sitepackages', 'PE_GCC_EXTERNAL': 'native', '__LMOD_REF_COUNT_PE_DSMML_PKGCONFIG_LIBS': 'dsmml:1', 'NVFUSER_BUILD_VERSION': '0ff5802', 'HPCX_VERSION': '2.19', 'CRAY_CPU_TARGET': 'x86-milan', 'CRAY_PE_LIBSCI_PREFIX_DIR': '/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64', 'CRAYPE_DIR': '/opt/cray/pe/craype/2.7.30', 'CRAY_XPMEM_INCLUDE_OPTS': '-I/opt/cray/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta/include', '_ModuleTable003_': 'IHt9LApzdGFja0RlcHRoID0gMCwKc3RhdHVzID0gImFjdGl2ZSIsCnVzZXJOYW1lID0gImNwZSIsCndWID0gIl4wMDAwMDAyMy4wMDAwMDAwMTIuKnpmaW5hbCIsCn0sClsiY3JheS1kc21tbCJdID0gewpmbiA9ICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb3JlL2NyYXktZHNtbWwvMC4yLjIubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1kc21tbC8wLjIuMiIsCmxvYWRPcmRlciA9IDYsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheS1kc21tbC8wLjIuMiIsCndWID0gIl4wMDAwMDAwMC4wMDAwMDAwMDIuMDAwMDAwMDAyLip6ZmluYWwiLAp9LApbImNyYXktbGlic2NpIl0gPSB7CmZuID0gIi9vcHQv', 'HYDRA_BOOTSTRAP': 'slurm', 'MODULEPATH_ROOT': '/opt/cray/pe/modulefiles', 'TORCH_CUDNN_V8_API_ENABLED': '1', 'NVM_DIR': '/usr/local/nvm', 'VSCODE_GIT_ASKPASS_EXTRA_ARGS': '', 'CUDA_VISIBLE_DEVICES': '0,1,2,3', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'PE_MPICH_GTL_LIBS_nvidia80': '-lmpi_gtl_cuda', 'PE_PKGCONFIG_LIBS': 'cudatoolkit_12.2:mpich:libsci_mpi:libsci:dsmml', 'PE_MPICH_GENCOMPILERS_GNU': '12.3', 'LESSCLOSE': 'lessclose.sh %s %s', 'LMOD_FAMILY_CRAYPE_ACCEL_VERSION': 'false', 'XDG_SESSION_CLASS': 'user', 'LMOD_PKG': '/opt/cray/pe/lmod/lmod', 'SLURM_SCRIPT_CONTEXT': 'prolog_task', 'PE_LIBSCI_GENCOMPILERS_GNU_x86_64': '12.3', 'PYTHONPATH': '/opt/nersc/pymon', 'TERM': 'xterm-256color', 'PE_MPICH_GTL_DIR_ponteVecchio': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'LMOD_FAMILY_CRAYPE_CPU_VERSION': 'false', 'G_FILENAME_ENCODING': '@locale,UTF-8,ISO-8859-15,CP1252', 'HOST': 'login15', 'GDRCOPY_VERSION': '2.3.1-1', 'PE_MPICH_FORTRAN_PKGCONFIG_LIBS': 'mpichf90', 'NVFUSER_VERSION': '0ff5802', 'LESSOPEN': 'lessopen.sh %s', 'PE_MPICH_GTL_DIR_nvidia90': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'USER': 'lokeshb', 'CFS': '/global/cfs/cdirs', 'CRAY_DSMML_DIR': '/opt/cray/pe/dsmml/0.2.2/dsmml', 'OPENMPI_VERSION': '4.1.7', 'PE_LIBSCI_VOLATILE_PRGENV': 'GNU', 'LMOD_FAMILY_LIBSCI_VERSION': '23.12.5', 'LMOD_FAMILY_CRAYPE_VERSION': '2.7.30', 'NVJPEG_VERSION': '12.3.1.117', 'LIBRARY_PATH': '/usr/local/cuda/lib64/stubs:', 'SLURM_NODELIST': 'nid001036', 'PE_DSMML_PKGCONFIG_LIBS': 'dsmml', '__LMOD_REF_COUNT_PE_MPICH_FORTRAN_PKGCONFIG_LIBS': 'mpichf90:1', 'VSCODE_GIT_IPC_HANDLE': '/run/user/105785/vscode-git-9051b97600.sock', 'PYTHONIOENCODING': 'utf-8', 'ENVIRONMENT': 'BATCH', 'CRAYPAT_OPTS_EXECUTABLE': 'libexec64/opts', 'PE_MPICH_GTL_LIBS_amd_gfx942': '-lmpi_gtl_hsa', 'CRAYPAT_ROOT': '/opt/cray/pe/perftools/23.12.0', 'PE_MPICH_GTL_LIBS_amd_gfx940': '-lmpi_gtl_hsa', 'MORE': '-sl', 'CRAY_MPICH_VER': '8.1.28', 'LOADEDMODULES': 'craype-x86-milan:libfabric/1.15.2.0:craype-network-ofi:xpmem/2.6.2-2.5_2.38__gd067c3f.shasta:PrgEnv-gnu/8.5.0:cray-dsmml/0.2.2:cray-libsci/23.12.5:cray-mpich/8.1.28:craype/2.7.30:gcc-native/12.3:perftools-base/23.12.0:cpe/23.12:cudatoolkit/12.2:craype-accel-nvidia80:gpu/1.0', 'SLURM_JOB_ACCOUNT': 'm4392_g', 'CSHEDIT': 'emacs', 'SLURM_PRIO_PROCESS': '0', 'PE_LIBSCI_OMP_REQUIRES': ' ', 'CRAY_DSMML_ROOTDIR': '/opt/cray/pe/dsmml/0.2.2', 'NERSC_LMOD_CONFIGDIR': '/opt/nersc/pe/etc/lmod', 'SLURM_NPROCS': '4', 'LMOD_ROOT': '/opt/cray/pe/lmod', 'NVHPC_CUDA_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'SHLVL': '5', '_ModuleTable012_': 'Cn0sCn0sCm1wYXRoQSA9IHsKIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL3BlcmZ0b29scy8yMy4xMi4wIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9jb21uZXQvZ251LzEyLjAvb2ZpLzEuMCIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvbWl4X2NvbXBpbGVycyIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29tcGlsZXIvZ251LzEyLjAiCiwgIi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL21waS9nbnUvMTIuMC9vZmkvMS4wL2NyYXktbXBpY2gvOC4wIgosICIvb3B0L2NyYXkvcGUvbG1vZC9tb2R1bGVmaWxlcy9uZXQvb2ZpLzEuMCIKLCAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3B1L3g4Ni1t', 'CRAYPE_NETWORK_TARGET': 'ofi', 'SLURM_NNODES': '1', 'BASH_ENV': '/opt/cray/pe/lmod/lmod/init/bash', '__LMOD_REF_COUNT_PE_MPICH_FIXED_PRGENV': 'GNU:1', 'PE_MPICH_GTL_LIBS_nvidia70': '-lmpi_gtl_cuda', '_ModuleTable006_': 'cmF5cGUtYWNjZWwtbnZpZGlhODAiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUtYWNjZWwtbnZpZGlhODAubHVhIiwKZnVsbE5hbWUgPSAiY3JheXBlLWFjY2VsLW52aWRpYTgwIiwKbG9hZE9yZGVyID0gMTQsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheXBlLWFjY2VsLW52aWRpYTgwIiwKd1YgPSAiTS4qemZpbmFsIiwKfSwKWyJjcmF5cGUtbmV0d29yay1vZmkiXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdC9jcmF5cGUtbmV0d29yay1vZmkubHVhIiwKZnVs', 'WINDOWMANAGER': 'xterm', 'PAGER': 'less', 'CRAY_DSMML_BASEDIR': '/opt/cray/pe/dsmml/0.2.2', 'CRAY_TCMALLOC_MEMFS_FORCE': '1', 'CRAYPE_LINK_TYPE': 'dynamic', 'LMOD_sys': 'Linux', 'PE_LIBSCI_OMP_REQUIRES_openmp': '_mp', 'PAT_RT_PERFCTR_DISABLE_COMPONENTS': 'nvml,rocm_smi', 'PE_LIBSCI_MODULE_NAME': 'cray-libsci/23.12.5', '__LMOD_REF_COUNT_PE_FORTRAN_PKGCONFIG_LIBS': 'mpichf90:1', 'LIBGL_DEBUG': 'quiet', 'PE_ENV': 'GNU', 'CUDNN_VERSION': '9.1.0.70', '_ModuleTable009_': 'cFQgPSB7fSwKc3RhY2tEZXB0aCA9IDEsCnN0YXR1cyA9ICJhY3RpdmUiLAp1c2VyTmFtZSA9ICJnY2MtbmF0aXZlLzEyLjMiLAp3ViA9ICJeMDAwMDAwMTIuMDAwMDAwMDAzLip6ZmluYWwiLAp9LApncHUgPSB7CmZuID0gIi9vcHQvbmVyc2MvcGUvbW9kdWxlZmlsZXMvZ3B1LzEuMC5sdWEiLApmdWxsTmFtZSA9ICJncHUvMS4wIiwKbG9hZE9yZGVyID0gMTUsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAwLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiZ3B1IiwKd1YgPSAiMDAwMDAwMDAxLip6ZmluYWwiLAp9LApsaWJmYWJyaWMgPSB7CmZuID0gIi9vcHQvY3JheS9tb2R1bGVmaWxlcy9saWJmYWJyaWMvMS4xNS4yLjAiLApmdWxsTmFtZSA9ICJsaWJmYWJyaWMv', 'HDF5_USE_FILE_LOCKING': 'FALSE', 'PE_MPICH_GTL_LIBS_ponteVecchio': '-lmpi_gtl_ze', 'CRAY_MPICH_VERSION': '8.1.28', '__LMOD_REF_COUNT_MANPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/doc/man:1;/opt/cray/pe/perftools/23.12.0/man:1;/opt/cray/pe/papi/7.0.1.2/share/pdoc/man:1;/opt/cray/pe/craype/2.7.30/man:1;/opt/cray/pe/mpich/8.    ddp_setup()
  File "/workspace/utils/misc.py", line 50, in ddp_setup
1.28/ofi/man:1;/opt/cray/pe/mpich/8.1.28/man/mpich:1;/opt/cray/pe/libsci/23.12.5/share/man:1;/opt/cray/pe/dsmml/0.2.2/dsmml/man:1;/opt/cray/libfabric/1.15.2.0/share/man:1;/opt/cray/pe/lmod/lmod/share/man:1;/usr/local/man:1;/usr/share/man:1;/usr/man:1', 'PERFTOOLS_VERSION': '23.12.0', 'XDG_SESSION_ID': '148161', 'NSIGHT_COMPUTE_VERSION': '2024.1.1.4', 'SLURM_SUBMIT_HOST': 'login15', 'DALI_VERSION': '1.37.1', '_ModuleTable001_': 'X01vZHVsZVRhYmxlXyA9IHsKTVR2ZXJzaW9uID0gMywKY19yZWJ1aWxkVGltZSA9IGZhbHNlLApjX3Nob3J0VGltZSA9IGZhbHNlLApkZXB0aFQgPSB7fSwKZmFtaWx5ID0gewpQcmdFbnYgPSAiUHJnRW52LWdudSIsCmNvbXBpbGVyID0gImdjYy1uYXRpdmUiLApjcmF5cGUgPSAiY3JheXBlIiwKY3JheXBlX2FjY2VsID0gImNyYXlwZS1hY2NlbC1udmlkaWE4MCIsCmNyYXlwZV9jcHUgPSAiY3JheXBlLXg4Ni1taWxhbiIsCmNyYXlwZV9uZXR3b3JrID0gImNyYXlwZS1uZXR3b3JrLW9maSIsCmN1ZGF0b29sa2l0ID0gImN1ZGF0b29sa2l0IiwKZ2NjX2NvbXBpbGVyID0gImdjYy1uYXRpdmUiLApoYXJkd2FyZSA9ICJncHUiLApsaWJzY2kgPSAiY3JheS1saWJzY2kiLAptcGkg', 'JUPYTER_PORT': '8888', 'PYTORCH_HOME': '/opt/pytorch/pytorch', 'LD_LIBRARY_PATH': '/usr/local/cuda-12.2/compat:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:/opt/cray/pe/papi/7.0.1.2/lib64:/opt/cray/libfabric/1.15.2.0/lib64:/opt/cray/libfabric/1.15.2.0/lib64', 'LMOD_FAMILY_CRAYPE_NETWORK_VERSION': 'false', 'NVIDIA_BUILD_ID': '91431255', 'LMOD_FAMILY_COMPILER': 'gcc-native', 'XDG_RUNTIME_DIR': '/run/user/105785', 'SLURM_JOB_ID': '29803093', '_ModuleTable014_': 'c2VNUEFUSCA9ICIvb3B0L2NyYXkvcGUvbW9kdWxlZmlsZXMvTGludXg6L29wdC9jcmF5L3BlL21vZHVsZWZpbGVzL0NvcmU6L29wdC9jcmF5L3BlL2xtb2QvbG1vZC9tb2R1bGVmaWxlcy9Db3JlOi9vcHQvY3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvcmU6L29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY3JheXBlLXRhcmdldHMvZGVmYXVsdDovZ2xvYmFsL2NvbW1vbi9zb2Z0d2FyZS9uZXJzYy9wZS9tb2R1bGVmaWxlc19ob3RmaXhlczovb3B0L25lcnNjL3BlL21vZHVsZWZpbGVzOi91c3Ivc2hhcmUvbG1vZC9sbW9kL21vZHVsZWZpbGVzL0NvcmU6L29wdC9jcmF5L21vZHVsZWZpbGVzIiwKfQo=', 'PE_MPICH_GTL_DIR_amd_gfx90a': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'SLURM_NODEID': '0', '_ModuleTable004_': 'Y3JheS9wZS9sbW9kL21vZHVsZWZpbGVzL2NvbXBpbGVyL2dudS8xMi4wL2NyYXktbGlic2NpLzIzLjEyLjUubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1saWJzY2kvMjMuMTIuNSIsCmxvYWRPcmRlciA9IDcsCnByb3BUID0ge30sCnN0YWNrRGVwdGggPSAxLApzdGF0dXMgPSAiYWN0aXZlIiwKdXNlck5hbWUgPSAiY3JheS1saWJzY2kvMjMuMTIuNSIsCndWID0gIl4wMDAwMDAyMy4wMDAwMDAwMTIuMDAwMDAwMDA1Lip6ZmluYWwiLAp9LApbImNyYXktbXBpY2giXSA9IHsKZm4gPSAiL29wdC9jcmF5L3BlL2xtb2QvbW9kdWxlZmlsZXMvY29tbmV0L2dudS8xMi4wL29maS8xLjAvY3JheS1tcGljaC84LjEuMjgubHVhIiwKZnVsbE5hbWUgPSAiY3JheS1tcGljaC84LjEuMjgiLAps', 'LMOD_FAMILY_MPI_VERSION': '8.1.28', 'CRAY_PERFTOOLS_PREFIX': '/opt/cray/pe/perftools/23.12.0', 'LMOD_MODULERCFILE': '/opt/nersc/pe/etc/lmod/modulerc.lua', 'SSH_CLIENT': '103.232.241.199 35000 22', '__lmod_my_status': '$?;', 'OMPI_MCA_coll_hcoll_enable': '0', 'FI_MR_CACHE_MONITOR': 'userfaultfd', 'XTPE_LINK_TYPE': 'dynamic', 'OPAL_PREFIX': '/opt/hpcx/ompi', 'LMOD_FAMILY_MPI': 'cray-mpich', 'CSHRCREAD': 'true', 'LMOD_SYSHOST': 'perlmutter', 'CRAY_MPICH_BASEDIR': '/opt/cray/pe/mpich/8.1.28/ofi', 'CUDA_DRIVER_VERSION': '550.54.15', 'LC_ALL': 'C.UTF-8', 'TRANSFORMER_ENGINE_VERSION': '1.6', 'LMOD_FAMILY_COMPILER_VERSION': '12.3', 'PYTORCH_BUILD_VERSION': '2.4.0a0+07cecf4', '_CUDA_COMPAT_PATH': '/usr/local/cuda/compat', 'VSCODE_GIT_ASKPASS_MAIN': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/extensions/git/dist/askpass-main.js', 'CUDA_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'NERSC_HOST': 'perlmutter', 'CRAY_PERFTOOLS_VERSION': '23.12.0', 'PE_GCC_LEVEL': '12', 'PE_MPICH_GTL_DIR_amd_gfx908': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'PE_MPICH_GTL_DIR_amd_gfx906': '-L/opt/cray/pe/mpich/8.1.28/gtl/lib', 'XDG_DATA_DIRS': '/usr/share', 'CUDA_MODULE_LOADING': 'LAZY', '__LMOD_REF_COUNT_PE_PRODUCT_LIST': 'CRAYPE:1;CRAYPE_X86_MILAN:1;PERFTOOLS:1;CRAYPAT:1;CRAY_HPC_SDK:1;CRAY_ACCEL:1', 'SLURM_JOB_LICENSES': 'u1:1', 'SRUN_CPUS_PER_TASK': '32', 'LMOD_FAMILY_LIBSCI': 'cray-libsci', 'GCC_PREFIX': '/usr/lib64/gcc/x86_64-suse-linux/12', 'NVIDIA_REQUIRE_JETPACK_HOST_MOUNTS': '', 'BROWSER': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/bin/helpers/browser.sh', 'PATH': '/global/u1/l/lokeshb/.vscode-server/bin/fee1edb8d6d72a0ddff41e5f71a671c23ed924b9/bin/remote-cli:/opt/nersc/pe/bin:/global/common/software/nersc/bin:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/compute-sanitizer:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/bin:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/libnvvp:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Compute:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/profilers/Nsight_Systems/bin:/opt/cray/pe/perftools/23.12.0/bin:/opt/cray/pe/papi/7.0.1.2/bin:/opt/cray/pe/craype/2.7.30/bin:/opt/cray/pe/mpich/8.1.28/ofi/gnu/12.3/bin:/opt/cray/pe/mpich/8.1.28/bin:/opt/cray/libfabric/1.15.2.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/lib/mit/bin:/opt/cray/pe/bin', 'SLURM_JOB_NAME': 'pytorch_distributed_training', 'MODULEPATH': '/opt/cray/pe/lmod/modulefiles/perftools/23.12.0:/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0:/opt/cray/pe/lmod/modulefiles/mix_compilers:/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0:/opt/cray/pe/lmod/modulefiles/mpi/gnu/12.0/ofi/1.0/cray-mpich/8.0:/opt/cray/pe/lmod/modulefiles/net/ofi/1.0:/opt/cray/pe/lmod/modulefiles/cpu/x86-milan/1.0:/opt/cray/pe/modulefiles/Linux:/opt/cray/pe/modulefiles/Core:/opt/cray/pe/lmod/lmod/modulefiles/Core:/opt/cray/pe/lmod/modulefiles/core:/opt/cray/pe/lmod/modulefiles/craype-targets/default:/global/common/software/nersc/pe/modulefiles_hotfixes:/opt/nersc/pe/modulefiles:/usr/share/lmod/lmod/modulefiles/Core:/opt/cray/modulefiles', '__LMOD_REF_COUNT_PE_PKGCONFIG_PRODUCTS': 'PE_MPICH:1;PE_LIBSCI:1;PE_DSMML:1;PE_XPMEM:1', 'SLURM_NTASKS_PER_NODE': '4', '_LMFILES_': '/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-x86-milan.lua:/opt/cray/modulefiles/libfabric/1.15.2.0:/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-network-ofi.lua:/opt/cray/modulefiles/xpmem/2.6.2-2.5_2.38__gd067c3f.shasta:/opt/cray/pe/lmod/modulefiles/core/PrgEnv-gnu/8.5.0.lua:/opt/cray/pe/lmod/modulefiles/core/cray-dsmml/0.2.2.lua:/opt/cray/pe/lmod/modulefiles/compiler/gnu/12.0/cray-libsci/23.12.5.lua:/opt/cray/pe/lmod/modulefiles/comnet/gnu/12.0/ofi/1.0/cray-mpich/8.1.28.lua:/opt/cray/pe/lmod/modulefiles/core/craype/2.7.30.lua:/opt/cray/pe/lmod/modulefiles/core/gcc-native/12.3.lua:/opt/cray/pe/lmod/modulefiles/core/perftools-base/23.12.0.lua:/opt/cray/pe/lmod/modulefiles/core/cpe/23.12.lua:/opt/cray/pe/lmod/modulefiles/core/cudatoolkit/12.2.lua:/opt/cray/pe/lmod/modulefiles/craype-targets/default/craype-accel-nvidia80.lua:/opt/nersc/pe/modulefiles/gpu/1.0.lua', 'CRAY_CUDATOOLKIT_INCLUDE_OPTS': '-I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/include -I/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include', 'CRAY_CUDATOOLKIT_DIR': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'LMOD_FAMILY_CRAYPE_CPU': 'craype-x86-milan', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/105785/bus', 'PROFILEREAD': 'true', 'LMOD_CMD': '/opt/cray/pe/lmod/lmod/libexec/lmod', 'LMOD_SYSTEM_NAME': 'perlmutter', 'PE_LIBSCI_VOLATILE_PKGCONFIG_PATH': '/opt/cray/pe/libsci/23.12.5/@PRGENV@/@PE_LIBSCI_GENCOMPS@/@PE_LIBSCI_TARGET@/lib/pkgconfig', 'MOFED_VERSION': '5.4-rdmacore39.0', 'MAIL': '/var/spool/mail/lokeshb', 'HOSTTYPE': 'x86_64', '__LMOD_REF_COUNT_LD_LIBRARY_PATH': '/usr/local/cuda-12.2/compat:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/CUPTI/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/extras/Debugger/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/nvvm/lib64:1;/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/lib64:1;/opt/cray/pe/papi/7.0.1.2/lib64:1;/opt/cray/libfabric/1.15.2.0/lib64:1', 'CRAY_DSMML_VERSION': '0.2.2', 'NVIDIA_PYTORCH_VERSION': '24.05', '__LMOD_REF_COUNT_PE_PKGCONFIG_LIBS': 'cudatoolkit_12.2:1;mpich:1;libsci_mpi:1;libsci:1;dsmml:1', 'TRTOSS_VERSION': '24.05', 'LMOD_SYSTEM_DEFAULT_MODULES': 'craype-x86-milan:craype-network-ofi:perftools-base:xpmem:PrgEnv-gnu:cpe:gpu', 'OMPI_MCA_plm_slurm_args': '--external-launcher', 'SLURM_JOB_GID': '105785', 'LMOD_FAMILY_CRAYPE': 'craype', 'CPATH': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/math_libs/12.2/include:/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/include', 'CRAY_PE_LIBSCI_VERSION': '23.12.5', 'LESSKEY': '/etc/lesskey.bin', 'TORCH_ALLOW_TF32_CUBLAS_OVERRIDE': '1', 'CUDATOOLKIT_HOME': '/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2', 'SLURM_JOB_NODELIST': 'nid001036', 'PE_MPICH_MODULE_NAME': 'cray-mpich', 'CRAY_PE_LIBSCI_PREFIX': '/opt/cray/pe/libsci/23.12.5/GNU/12.3/x86_64', 'LMOD_FAMILY_CUDATOOLKIT_VERSION': '12.2', 'TERM_PROGRAM': 'vscode', 'MPICH_OFI_CXI_    sync_file = _get_sync_file()
  File "/workspace/utils/misc.py", line 41, in _get_sync_file
    sync_file_dir, os.environ['SLURM_JOB_ID'], os.environ['SLURM_STEP_ID'])
  File "/usr/lib/python3.10/os.py", line 680, in __getitem__
    raise KeyError(key) from None
KeyError: 'SLURM_STEP_ID'
COUNTER_REPORT': '0', 'LMOD_FAMILY_CUDATOOLKIT': 'cudatoolkit', 'I_MPI_HYDRA_BOOTSTRAP': 'slurm', 'PE_FORTRAN_PKGCONFIG_LIBS': 'mpichf90', 'VSCODE_IPC_HOOK_CLI': '/run/user/105785/vscode-ipc-1e8eee9c-1197-4c37-8103-958d8969c114.sock', 'PE_MPICH_PKGCONFIG_VARIABLES': 'PE_MPICH_GTL_DIR_@accelerator@:PE_MPICH_GTL_LIBS_@accelerator@', 'LMOD_AVAIL_STYLE': 'grouped:system', 'CUDA_LAUNCH_BLOCKING': '1'})
WORLD_SIZE: 4, GLOBAL_RANK: 0
Traceback (most recent call last):
  File "/workspace/dist-training.py", line 280, in <module>
    main(args)
  File "/workspace/dist-training.py", line 263, in main
    ddp_setup()
  File "/workspace/utils/misc.py", line 50, in ddp_setup
    sync_file = _get_sync_file()
  File "/workspace/utils/misc.py", line 41, in _get_sync_file
    sync_file_dir, os.environ['SLURM_JOB_ID'], os.environ['SLURM_STEP_ID'])
  File "/usr/lib/python3.10/os.py", line 680, in __getitem__
    raise KeyError(key) from None
KeyError: 'SLURM_STEP_ID'
    ddp_setup()
  File "/workspace/utils/misc.py", line 50, in ddp_setup
    sync_file = _get_sync_file()
  File "/workspace/utils/misc.py", line 41, in _get_sync_file
    sync_file_dir, os.environ['SLURM_JOB_ID'], os.environ['SLURM_STEP_ID'])
  File "/usr/lib/python3.10/os.py", line 680, in __getitem__
    raise KeyError(key) from None
KeyError: 'SLURM_STEP_ID'
srun: error: nid001036: task 3: Exited with exit code 1
srun: Terminating StepId=29803093.0
slurmstepd: error: *** STEP 29803093.0 ON nid001036 CANCELLED AT 2024-08-26T15:29:20 ***
srun: error: nid001036: tasks 0-2: Exited with exit code 1
